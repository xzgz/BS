/* Copyright 1995-2002 Roger P. Woods, M.D. */
/* Modified 7/15/02 */


/*
 * This routine computes the derivative of a warp at a specified point
 *
 * Returns 0 if successful, error code otherwise
 */

#include "AIR.h"

AIR_Error AIR_diffg3D(double **es, const double i, const double j, const double k, double **ed, const unsigned int order, double *dx_pi, double *dx_pj, double *dx_pk)

/* (i,j,k) is the point, ed is the derivative, es are the parameters and dx_pi, dx_pj and dx_pk are storage */

{
	unsigned int coeffp=(order+1)*(order+2)*(order+3)/6;

	if(order>AIR_CONFIG_MAXORDER){
		return AIR_POLYNOMIAL_ORDER_ERROR;
	}

	/* Initialize work arrays */
	{
		unsigned int ii;
		
		for(ii=0;ii<coeffp;ii++){
			dx_pi[ii]=0.0;
			dx_pj[ii]=0.0;
			dx_pk[ii]=0.0;
		}
	}

	if(order!=0){
	
		double i1=i;
		double j1=j;
		double k1=k;
		
		dx_pi[1]=1.0;
		dx_pj[2]=1.0;
		dx_pk[3]=1.0;

	if(order>1){
	
		double i2=i1*i1;
		double j2=j1*j1;
		double k2=k1*k1;
		
		dx_pi[4]=2.0*i1;
		dx_pi[5]=j1;
		dx_pj[5]=i1;
		dx_pj[6]=2.0*j1;
		dx_pi[7]=k1;
		dx_pk[7]=i1;
		dx_pj[8]=k1;
		dx_pk[8]=j1;
		dx_pk[9]=2.0*k1;

	if(order>2){
	
		double i3=i2*i1;
		double j3=j2*j1;
		double k3=k2*k1;
		
		dx_pi[10]=3.0*i2;
		dx_pi[11]=2.0*i1*j1;
		dx_pj[11]=i2;
		dx_pi[12]=j2;
		dx_pj[12]=2.0*i1*j1;
		dx_pj[13]=3.0*j2;
		dx_pi[14]=2.0*i1*k1;
		dx_pk[14]=i2;
		dx_pi[15]=j1*k1;
		dx_pj[15]=i1*k1;
		dx_pk[15]=i1*j1;
		dx_pj[16]=2.0*j1*k1;
		dx_pk[16]=j2;
		dx_pi[17]=k2;
		dx_pk[17]=2.0*i1*k1;
		dx_pj[18]=k2;
		dx_pk[18]=2.0*j1*k1;
		dx_pk[19]=3.0*k2;

	if(order>3){
	
		double i4=i3*i1;
		double j4=j3*j1;
		double k4=k3*k1;
		
		dx_pi[20]=4.0*i3;
		dx_pi[21]=3.0*i2*j1;
		dx_pj[21]=i3;
		dx_pi[22]=2.0*i1*j2;
		dx_pj[22]=2.0*i2*j1;
		dx_pi[23]=j3;
		dx_pj[23]=3.0*i1*j2;
		dx_pj[24]=4.0*j3;
		dx_pi[25]=3.0*i2*k1;
		dx_pk[25]=i3;
		dx_pi[26]=2.0*i1*j1*k1;
		dx_pj[26]=i2*k1;
		dx_pk[26]=i2*j1;
		dx_pi[27]=j2*k1;
		dx_pj[27]=2.0*i1*j1*k1;
		dx_pk[27]=i1*j2;
		dx_pj[28]=3.0*j2*k1;
		dx_pk[28]=j3;
		dx_pi[29]=2.0*i1*k2;
		dx_pk[29]=2.0*i2*k1;
		dx_pi[30]=j1*k2;
		dx_pj[30]=i1*k2;
		dx_pk[30]=2.0*i1*j1*k1;
		dx_pj[31]=2.0*j1*k2;
		dx_pk[31]=2.0*j2*k1;
		dx_pi[32]=k3;
		dx_pk[32]=3.0*i1*k2;
		dx_pj[33]=k3;
		dx_pk[33]=3.0*j1*k2;
		dx_pk[34]=4.0*k3;
		
	if(order>4){
	
		double i5=i4*i1;
		double j5=j4*j1;
		double k5=k4*k1;
		
		dx_pi[35]=5.0*i4;
		dx_pi[36]=4.0*i3*j1;
		dx_pj[36]=i4;
		dx_pi[37]=3.0*i2*j2;
		dx_pj[37]=2.0*i3*j1;
		dx_pi[38]=2.0*i1*j3;
		dx_pj[38]=3.0*i2*j2;
		dx_pi[39]=j4;
		dx_pj[39]=4.0*i1*j3;
		dx_pj[40]=5.0*j4;
		dx_pi[41]=4.0*i3*k1;
		dx_pk[41]=i4;
		dx_pi[42]=3.0*i2*j1*k1;
		dx_pj[42]=i3*k1;
		dx_pk[42]=i3*j1;
		dx_pi[43]=2.0*i1*j2*k1;
		dx_pj[43]=2.0*i2*j1*k1;
		dx_pk[43]=i2*j2;
		dx_pi[44]=j3*k1;
		dx_pj[44]=3.0*i1*j2*k1;
		dx_pk[44]=i1*j3;
		dx_pj[45]=4.0*j3*k1;
		dx_pk[45]=j4;
		dx_pi[46]=3.0*i2*k2;
		dx_pk[46]=2.0*i3*k1;
		dx_pi[47]=2.0*i1*j1*k2;
		dx_pj[47]=i2*k2;
		dx_pk[47]=2.0*i2*j1*k1;
		dx_pi[48]=j2*k2;
		dx_pj[48]=2.0*i1*j1*k2;
		dx_pk[48]=2.0*i1*j2*k1;
		dx_pj[49]=3.0*j2*k2;
		dx_pk[49]=2.0*j3*k1;
		dx_pi[50]=2.0*i1*k3;
		dx_pk[50]=3.0*i2*k2;
		dx_pi[51]=j1*k3;
		dx_pj[51]=i1*k3;
		dx_pk[51]=3.0*i1*j1*k2;
		dx_pj[52]=2.0*j1*k3;
		dx_pk[52]=3.0*j2*k2;
		dx_pi[53]=k4;
		dx_pk[53]=4.0*i1*k3;
		dx_pj[54]=k4;
		dx_pk[54]=4.0*j1*k3;
		dx_pk[55]=5.0*k4;
		
	if(order>5){
	
		double i6=i5*i1;
		double j6=j5*j1;
		double k6=k5*k1;
		
		dx_pi[56]=6.0*i5;
		dx_pi[57]=5.0*i4*j1;
		dx_pj[57]=i5;
		dx_pi[58]=4.0*i3*j2;
		dx_pj[58]=2.0*i4*j1;
		dx_pi[59]=3.0*i2*j3;
		dx_pj[59]=3.0*i3*j2;
		dx_pi[60]=2.0*i1*j4;
		dx_pj[60]=4.0*i2*j3;
		dx_pi[61]=j5;
		dx_pj[61]=5.0*i1*j4;
		dx_pj[62]=6.0*j5;
		dx_pi[63]=5.0*i4*k1;
		dx_pk[63]=i5;
		dx_pi[64]=4.0*i3*j1*k1;
		dx_pj[64]=i4*k1;
		dx_pk[64]=i4*j1;
		dx_pi[65]=3.0*i2*j2*k1;
		dx_pj[65]=2.0*i3*j1*k1;
		dx_pk[65]=i3*j2;
		dx_pi[66]=2.0*i1*j3*k1;
		dx_pj[66]=3.0*i2*j2*k1;
		dx_pk[66]=i2*j3;
		dx_pi[67]=j4*k1;
		dx_pj[67]=4.0*i1*j3*k1;
		dx_pk[67]=i1*j4;
		dx_pj[68]=5.0*j4*k1;
		dx_pk[68]=j5;
		dx_pi[69]=4.0*i3*k2;
		dx_pk[69]=2.0*i4*k1;
		dx_pi[70]=3.0*i2*j1*k2;
		dx_pj[70]=i3*k2;
		dx_pk[70]=2.0*i3*j1*k1;
		dx_pi[71]=2.0*i1*j2*k2;
		dx_pj[71]=2.0*i2*j1*k2;
		dx_pk[71]=2.0*i2*j2*k1;
		dx_pi[72]=j3*k2;
		dx_pj[72]=3.0*i1*j2*k2;
		dx_pk[72]=2.0*i1*j3*k1;
		dx_pj[73]=4.0*j3*k2;
		dx_pk[73]=2.0*j4*k1;
		dx_pi[74]=3.0*i2*k3;
		dx_pk[74]=3.0*i3*k2;
		dx_pi[75]=2.0*i1*j1*k3;
		dx_pj[75]=i2*k3;
		dx_pk[75]=3.0*i2*j1*k2;
		dx_pi[76]=j2*k3;
		dx_pj[76]=2.0*i1*j1*k3;
		dx_pk[76]=3.0*i1*j2*k2;
		dx_pj[77]=3.0*j2*k3;
		dx_pk[77]=3.0*j3*k2;
		dx_pi[78]=2.0*i1*k4;
		dx_pk[78]=4.0*i2*k3;
		dx_pi[79]=j1*k4;
		dx_pj[79]=i1*k4;
		dx_pk[79]=4.0*i1*j1*k3;
		dx_pj[80]=2.0*j1*k4;
		dx_pk[80]=4.0*j2*k3;
		dx_pi[81]=k5;
		dx_pk[81]=5.0*i1*k4;
		dx_pj[82]=k5;
		dx_pk[82]=5.0*j1*k4;
		dx_pk[83]=6.0*k5;

	if(order>6){
	
		double i7=i6*i1;
		double j7=j6*j1;
		double k7=k6*k1;
		
		dx_pi[84]=7.0*i6;
		dx_pi[85]=6.0*i5*j1;
		dx_pj[85]=i6;
		dx_pi[86]=5.0*i4*j2;
		dx_pj[86]=2.0*i5*j1;
		dx_pi[87]=4.0*i3*j3;
		dx_pj[87]=3.0*i4*j2;
		dx_pi[88]=3.0*i2*j4;
		dx_pj[88]=4.0*i3*j3;
		dx_pi[89]=2.0*i1*j5;
		dx_pj[89]=5.0*i2*j4;
		dx_pi[90]=j6;
		dx_pj[90]=6.0*i1*j5;
		dx_pj[91]=7.0*j6;
		dx_pi[92]=6.0*i5*k1;
		dx_pk[92]=i6;
		dx_pi[93]=5.0*i4*j1*k1;
		dx_pj[93]=i5*k1;
		dx_pk[93]=i5*j1;
		dx_pi[94]=4.0*i3*j2*k1;
		dx_pj[94]=2.0*i4*j1*k1;
		dx_pk[94]=i4*j2;
		dx_pi[95]=3.0*i2*j3*k1;
		dx_pj[95]=3.0*i3*j2*k1;
		dx_pk[95]=i3*j3;
		dx_pi[96]=2.0*i1*j4*k1;
		dx_pj[96]=4.0*i2*j3*k1;
		dx_pk[96]=i2*j4;
		dx_pi[97]=j5*k1;
		dx_pj[97]=5.0*i1*j4*k1;
		dx_pk[97]=i1*j5;
		dx_pj[98]=6.0*j5*k1;
		dx_pk[98]=j6;
		dx_pi[99]=5.0*i4*k2;
		dx_pk[99]=2.0*i5*k1;
		dx_pi[100]=4.0*i3*j1*k2;
		dx_pj[100]=i4*k2;
		dx_pk[100]=2.0*i4*j1*k1;
		dx_pi[101]=3.0*i2*j2*k2;
		dx_pj[101]=2.0*i3*j1*k2;
		dx_pk[101]=2.0*i3*j2*k1;
		dx_pi[102]=2.0*i1*j3*k2;
		dx_pj[102]=3.0*i2*j2*k2;
		dx_pk[102]=2.0*i2*j3*k1;
		dx_pi[103]=j4*k2;
		dx_pj[103]=4.0*i1*j3*k2;
		dx_pk[103]=2.0*i1*j4*k1;
		dx_pj[104]=5.0*j4*k2;
		dx_pk[104]=2.0*j5*k1;
		dx_pi[105]=4.0*i3*k3;
		dx_pk[105]=3.0*i4*k2;
		dx_pi[106]=3.0*i2*j1*k3;
		dx_pj[106]=i3*k3;
		dx_pk[106]=3.0*i3*j1*k2;
		dx_pi[107]=2.0*i1*j2*k3;
		dx_pj[107]=2.0*i2*j1*k3;
		dx_pk[107]=3.0*i2*j2*k2;
		dx_pi[108]=j3*k3;
		dx_pj[108]=3.0*i1*j2*k3;
		dx_pk[108]=3.0*i1*j3*k2;
		dx_pj[109]=4.0*j3*k3;
		dx_pk[109]=3.0*j4*k2;
		dx_pi[110]=3.0*i2*k4;
		dx_pk[110]=4.0*i3*k3;
		dx_pi[111]=2.0*i1*j1*k4;
		dx_pj[111]=i2*k4;
		dx_pk[111]=4.0*i2*j1*k3;
		dx_pi[112]=j2*k4;
		dx_pj[112]=2.0*i1*j1*k4;
		dx_pk[112]=4.0*i1*j2*k3;
		dx_pj[113]=3.0*j2*k4;
		dx_pk[113]=4.0*j3*k3;
		dx_pi[114]=2.0*i1*k5;
		dx_pk[114]=5.0*i2*k4;
		dx_pi[115]=j1*k5;
		dx_pj[115]=i1*k5;
		dx_pk[115]=5.0*i1*j1*k4;
		dx_pj[116]=2.0*j1*k5;
		dx_pk[116]=5.0*j2*k4;
		dx_pi[117]=k6;
		dx_pk[117]=6.0*i1*k5;
		dx_pj[118]=k6;
		dx_pk[118]=6.0*j1*k5;
		dx_pk[119]=7.0*k6;

	if(order>7){
	
		double i8=i7*i1;
		double j8=j7*j1;
		double k8=k7*k1;
		
		dx_pi[120]=8.0*i7;
		dx_pi[121]=7.0*i6*j1;
		dx_pj[121]=i7;
		dx_pi[122]=6.0*i5*j2;
		dx_pj[122]=2.0*i6*j1;
		dx_pi[123]=5.0*i4*j3;
		dx_pj[123]=3.0*i5*j2;
		dx_pi[124]=4.0*i3*j4;
		dx_pj[124]=4.0*i4*j3;
		dx_pi[125]=3.0*i2*j5;
		dx_pj[125]=5.0*i3*j4;
		dx_pi[126]=2.0*i1*j6;
		dx_pj[126]=6.0*i2*j5;
		dx_pi[127]=j7;
		dx_pj[127]=7.0*i1*j6;
		dx_pj[128]=8.0*j7;
		dx_pi[129]=7.0*i6*k1;
		dx_pk[129]=i7;
		dx_pi[130]=6.0*i5*j1*k1;
		dx_pj[130]=i6*k1;
		dx_pk[130]=i6*j1;
		dx_pi[131]=5.0*i4*j2*k1;
		dx_pj[131]=2.0*i5*j1*k1;
		dx_pk[131]=i5*j2;
		dx_pi[132]=4.0*i3*j3*k1;
		dx_pj[132]=3.0*i4*j2*k1;
		dx_pk[132]=i4*j3;
		dx_pi[133]=3.0*i2*j4*k1;
		dx_pj[133]=4.0*i3*j3*k1;
		dx_pk[133]=i3*j4;
		dx_pi[134]=2.0*i1*j5*k1;
		dx_pj[134]=5.0*i2*j4*k1;
		dx_pk[134]=i2*j5;
		dx_pi[135]=j6*k1;
		dx_pj[135]=6.0*i1*j5*k1;
		dx_pk[135]=i1*j6;
		dx_pj[136]=7.0*j6*k1;
		dx_pk[136]=j7;
		dx_pi[137]=6.0*i5*k2;
		dx_pk[137]=2.0*i6*k1;
		dx_pi[138]=5.0*i4*j1*k2;
		dx_pj[138]=i5*k2;
		dx_pk[138]=2.0*i5*j1*k1;
		dx_pi[139]=4.0*i3*j2*k2;
		dx_pj[139]=2.0*i4*j1*k2;
		dx_pk[139]=2.0*i4*j2*k1;
		dx_pi[140]=3.0*i2*j3*k2;
		dx_pj[140]=3.0*i3*j2*k2;
		dx_pk[140]=2.0*i3*j3*k1;
		dx_pi[141]=2.0*i1*j4*k2;
		dx_pj[141]=4.0*i2*j3*k2;
		dx_pk[141]=2.0*i2*j4*k1;
		dx_pi[142]=j5*k2;
		dx_pj[142]=5.0*i1*j4*k2;
		dx_pk[142]=2.0*i1*j5*k1;
		dx_pj[143]=6.0*j5*k2;
		dx_pk[143]=2.0*j6*k1;
		dx_pi[144]=5.0*i4*k3;
		dx_pk[144]=3.0*i5*k2;
		dx_pi[145]=4.0*i3*j1*k3;
		dx_pj[145]=i4*k3;
		dx_pk[145]=3.0*i4*j1*k2;
		dx_pi[146]=3.0*i2*j2*k3;
		dx_pj[146]=2.0*i3*j1*k3;
		dx_pk[146]=3.0*i3*j2*k2;
		dx_pi[147]=2.0*i1*j3*k3;
		dx_pj[147]=3.0*i2*j2*k3;
		dx_pk[147]=3.0*i2*j3*k2;
		dx_pi[148]=j4*k3;
		dx_pj[148]=4.0*i1*j3*k3;
		dx_pk[148]=3.0*i1*j4*k2;
		dx_pj[149]=5.0*j4*k3;
		dx_pk[149]=3.0*j5*k2;
		dx_pi[150]=4.0*i3*k4;
		dx_pk[150]=4.0*i4*k3;
		dx_pi[151]=3.0*i2*j1*k4;
		dx_pj[151]=i3*k4;
		dx_pk[151]=4.0*i3*j1*k3;
		dx_pi[152]=2.0*i1*j2*k4;
		dx_pj[152]=2.0*i2*j1*k4;
		dx_pk[152]=4.0*i2*j2*k3;
		dx_pi[153]=j3*k4;
		dx_pj[153]=3.0*i1*j2*k4;
		dx_pk[153]=4.0*i1*j3*k3;
		dx_pj[154]=4.0*j3*k4;
		dx_pk[154]=4.0*j4*k3;
		dx_pi[155]=3.0*i2*k5;
		dx_pk[155]=5.0*i3*k4;
		dx_pi[156]=2.0*i1*j1*k5;
		dx_pj[156]=i2*k5;
		dx_pk[156]=5.0*i2*j1*k4;
		dx_pi[157]=j2*k5;
		dx_pj[157]=2.0*i1*j1*k5;
		dx_pk[157]=5.0*i1*j2*k4;
		dx_pj[158]=3.0*j2*k5;
		dx_pk[158]=5.0*j3*k4;
		dx_pi[159]=2.0*i1*k6;
		dx_pk[159]=6.0*i2*k5;
		dx_pi[160]=j1*k6;
		dx_pj[160]=i1*k6;
		dx_pk[160]=6.0*i1*j1*k5;
		dx_pj[161]=2.0*j1*k6;
		dx_pk[161]=6.0*j2*k5;
		dx_pi[162]=k7;
		dx_pk[162]=7.0*i1*k6;
		dx_pj[163]=k7;
		dx_pk[163]=7.0*j1*k6;
		dx_pk[164]=8.0*k7;

	if(order>8){
	
		double i9=i8*i1;
		double j9=j8*j1;
		double k9=k8*k1;
		
		dx_pi[165]=9.0*i8;
		dx_pi[166]=8.0*i7*j1;
		dx_pj[166]=i8;
		dx_pi[167]=7.0*i6*j2;
		dx_pj[167]=2.0*i7*j1;
		dx_pi[168]=6.0*i5*j3;
		dx_pj[168]=3.0*i6*j2;
		dx_pi[169]=5.0*i4*j4;
		dx_pj[169]=4.0*i5*j3;
		dx_pi[170]=4.0*i3*j5;
		dx_pj[170]=5.0*i4*j4;
		dx_pi[171]=3.0*i2*j6;
		dx_pj[171]=6.0*i3*j5;
		dx_pi[172]=2.0*i1*j7;
		dx_pj[172]=7.0*i2*j6;
		dx_pi[173]=j8;
		dx_pj[173]=8.0*i1*j7;
		dx_pj[174]=9.0*j8;
		dx_pi[175]=8.0*i7*k1;
		dx_pk[175]=i8;
		dx_pi[176]=7.0*i6*j1*k1;
		dx_pj[176]=i7*k1;
		dx_pk[176]=i7*j1;
		dx_pi[177]=6.0*i5*j2*k1;
		dx_pj[177]=2.0*i6*j1*k1;
		dx_pk[177]=i6*j2;
		dx_pi[178]=5.0*i4*j3*k1;
		dx_pj[178]=3.0*i5*j2*k1;
		dx_pk[178]=i5*j3;
		dx_pi[179]=4.0*i3*j4*k1;
		dx_pj[179]=4.0*i4*j3*k1;
		dx_pk[179]=i4*j4;
		dx_pi[180]=3.0*i2*j5*k1;
		dx_pj[180]=5.0*i3*j4*k1;
		dx_pk[180]=i3*j5;
		dx_pi[181]=2.0*i1*j6*k1;
		dx_pj[181]=6.0*i2*j5*k1;
		dx_pk[181]=i2*j6;
		dx_pi[182]=j7*k1;
		dx_pj[182]=7.0*i1*j6*k1;
		dx_pk[182]=i1*j7;
		dx_pj[183]=8.0*j7*k1;
		dx_pk[183]=j8;
		dx_pi[184]=7.0*i6*k2;
		dx_pk[184]=2.0*i7*k1;
		dx_pi[185]=6.0*i5*j1*k2;
		dx_pj[185]=i6*k2;
		dx_pk[185]=2.0*i6*j1*k1;
		dx_pi[186]=5.0*i4*j2*k2;
		dx_pj[186]=2.0*i5*j1*k2;
		dx_pk[186]=2.0*i5*j2*k1;
		dx_pi[187]=4.0*i3*j3*k2;
		dx_pj[187]=3.0*i4*j2*k2;
		dx_pk[187]=2.0*i4*j3*k1;
		dx_pi[188]=3.0*i2*j4*k2;
		dx_pj[188]=4.0*i3*j3*k2;
		dx_pk[188]=2.0*i3*j4*k1;
		dx_pi[189]=2.0*i1*j5*k2;
		dx_pj[189]=5.0*i2*j4*k2;
		dx_pk[189]=2.0*i2*j5*k1;
		dx_pi[190]=j6*k2;
		dx_pj[190]=6.0*i1*j5*k2;
		dx_pk[190]=2.0*i1*j6*k1;
		dx_pj[191]=7.0*j6*k2;
		dx_pk[191]=2.0*j7*k1;
		dx_pi[192]=6.0*i5*k3;
		dx_pk[192]=3.0*i6*k2;
		dx_pi[193]=5.0*i4*j1*k3;
		dx_pj[193]=i5*k3;
		dx_pk[193]=3.0*i5*j1*k2;
		dx_pi[194]=4.0*i3*j2*k3;
		dx_pj[194]=2.0*i4*j1*k3;
		dx_pk[194]=3.0*i4*j2*k2;
		dx_pi[195]=3.0*i2*j3*k3;
		dx_pj[195]=3.0*i3*j2*k3;
		dx_pk[195]=3.0*i3*j3*k2;
		dx_pi[196]=2.0*i1*j4*k3;
		dx_pj[196]=4.0*i2*j3*k3;
		dx_pk[196]=3.0*i2*j4*k2;
		dx_pi[197]=j5*k3;
		dx_pj[197]=5.0*i1*j4*k3;
		dx_pk[197]=3.0*i1*j5*k2;
		dx_pj[198]=6.0*j5*k3;
		dx_pk[198]=3.0*j6*k2;
		dx_pi[199]=5.0*i4*k4;
		dx_pk[199]=4.0*i5*k3;
		dx_pi[200]=4.0*i3*j1*k4;
		dx_pj[200]=i4*k4;
		dx_pk[200]=4.0*i4*j1*k3;
		dx_pi[201]=3.0*i2*j2*k4;
		dx_pj[201]=2.0*i3*j1*k4;
		dx_pk[201]=4.0*i3*j2*k3;
		dx_pi[202]=2.0*i1*j3*k4;
		dx_pj[202]=3.0*i2*j2*k4;
		dx_pk[202]=4.0*i2*j3*k3;
		dx_pi[203]=j4*k4;
		dx_pj[203]=4.0*i1*j3*k4;
		dx_pk[203]=4.0*i1*j4*k3;
		dx_pj[204]=5.0*j4*k4;
		dx_pk[204]=4.0*j5*k3;
		dx_pi[205]=4.0*i3*k5;
		dx_pk[205]=5.0*i4*k4;
		dx_pi[206]=3.0*i2*j1*k5;
		dx_pj[206]=i3*k5;
		dx_pk[206]=5.0*i3*j1*k4;
		dx_pi[207]=2.0*i1*j2*k5;
		dx_pj[207]=2.0*i2*j1*k5;
		dx_pk[207]=5.0*i2*j2*k4;
		dx_pi[208]=j3*k5;
		dx_pj[208]=3.0*i1*j2*k5;
		dx_pk[208]=5.0*i1*j3*k4;
		dx_pj[209]=4.0*j3*k5;
		dx_pk[209]=5.0*j4*k4;
		dx_pi[210]=3.0*i2*k6;
		dx_pk[210]=6.0*i3*k5;
		dx_pi[211]=2.0*i1*j1*k6;
		dx_pj[211]=i2*k6;
		dx_pk[211]=6.0*i2*j1*k5;
		dx_pi[212]=j2*k6;
		dx_pj[212]=2.0*i1*j1*k6;
		dx_pk[212]=6.0*i1*j2*k5;
		dx_pj[213]=3.0*j2*k6;
		dx_pk[213]=6.0*j3*k5;
		dx_pi[214]=2.0*i1*k7;
		dx_pk[214]=7.0*i2*k6;
		dx_pi[215]=j1*k7;
		dx_pj[215]=i1*k7;
		dx_pk[215]=7.0*i1*j1*k6;
		dx_pj[216]=2.0*j1*k7;
		dx_pk[216]=7.0*j2*k6;
		dx_pi[217]=k8;
		dx_pk[217]=8.0*i1*k7;
		dx_pj[218]=k8;
		dx_pk[218]=8.0*j1*k7;
		dx_pk[219]=9.0*k8;

	if(order>9){
	
		double i10=i9*i1;
		double j10=j9*j1;
		double k10=k9*k1;
		
		dx_pi[220]=10.0*i9;
		dx_pi[221]=9.0*i8*j1;
		dx_pj[221]=i9;
		dx_pi[222]=8.0*i7*j2;
		dx_pj[222]=2.0*i8*j1;
		dx_pi[223]=7.0*i6*j3;
		dx_pj[223]=3.0*i7*j2;
		dx_pi[224]=6.0*i5*j4;
		dx_pj[224]=4.0*i6*j3;
		dx_pi[225]=5.0*i4*j5;
		dx_pj[225]=5.0*i5*j4;
		dx_pi[226]=4.0*i3*j6;
		dx_pj[226]=6.0*i4*j5;
		dx_pi[227]=3.0*i2*j7;
		dx_pj[227]=7.0*i3*j6;
		dx_pi[228]=2.0*i1*j8;
		dx_pj[228]=8.0*i2*j7;
		dx_pi[229]=j9;
		dx_pj[229]=9.0*i1*j8;
		dx_pj[230]=10.0*j9;
		dx_pi[231]=9.0*i8*k1;
		dx_pk[231]=i9;
		dx_pi[232]=8.0*i7*j1*k1;
		dx_pj[232]=i8*k1;
		dx_pk[232]=i8*j1;
		dx_pi[233]=7.0*i6*j2*k1;
		dx_pj[233]=2.0*i7*j1*k1;
		dx_pk[233]=i7*j2;
		dx_pi[234]=6.0*i5*j3*k1;
		dx_pj[234]=3.0*i6*j2*k1;
		dx_pk[234]=i6*j3;
		dx_pi[235]=5.0*i4*j4*k1;
		dx_pj[235]=4.0*i5*j3*k1;
		dx_pk[235]=i5*j4;
		dx_pi[236]=4.0*i3*j5*k1;
		dx_pj[236]=5.0*i4*j4*k1;
		dx_pk[236]=i4*j5;
		dx_pi[237]=3.0*i2*j6*k1;
		dx_pj[237]=6.0*i3*j5*k1;
		dx_pk[237]=i3*j6;
		dx_pi[238]=2.0*i1*j7*k1;
		dx_pj[238]=7.0*i2*j6*k1;
		dx_pk[238]=i2*j7;
		dx_pi[239]=j8*k1;
		dx_pj[239]=8.0*i1*j7*k1;
		dx_pk[239]=i1*j8;
		dx_pj[240]=9.0*j8*k1;
		dx_pk[240]=j9;
		dx_pi[241]=8.0*i7*k2;
		dx_pk[241]=2.0*i8*k1;
		dx_pi[242]=7.0*i6*j1*k2;
		dx_pj[242]=i7*k2;
		dx_pk[242]=2.0*i7*j1*k1;
		dx_pi[243]=6.0*i5*j2*k2;
		dx_pj[243]=2.0*i6*j1*k2;
		dx_pk[243]=2.0*i6*j2*k1;
		dx_pi[244]=5.0*i4*j3*k2;
		dx_pj[244]=3.0*i5*j2*k2;
		dx_pk[244]=2.0*i5*j3*k1;
		dx_pi[245]=4.0*i3*j4*k2;
		dx_pj[245]=4.0*i4*j3*k2;
		dx_pk[245]=2.0*i4*j4*k1;
		dx_pi[246]=3.0*i2*j5*k2;
		dx_pj[246]=5.0*i3*j4*k2;
		dx_pk[246]=2.0*i3*j5*k1;
		dx_pi[247]=2.0*i1*j6*k2;
		dx_pj[247]=6.0*i2*j5*k2;
		dx_pk[247]=2.0*i2*j6*k1;
		dx_pi[248]=j7*k2;
		dx_pj[248]=7.0*i1*j6*k2;
		dx_pk[248]=2.0*i1*j7*k1;
		dx_pj[249]=8.0*j7*k2;
		dx_pk[249]=2.0*j8*k1;
		dx_pi[250]=7.0*i6*k3;
		dx_pk[250]=3.0*i7*k2;
		dx_pi[251]=6.0*i5*j1*k3;
		dx_pj[251]=i6*k3;
		dx_pk[251]=3.0*i6*j1*k2;
		dx_pi[252]=5.0*i4*j2*k3;
		dx_pj[252]=2.0*i5*j1*k3;
		dx_pk[252]=3.0*i5*j2*k2;
		dx_pi[253]=4.0*i3*j3*k3;
		dx_pj[253]=3.0*i4*j2*k3;
		dx_pk[253]=3.0*i4*j3*k2;
		dx_pi[254]=3.0*i2*j4*k3;
		dx_pj[254]=4.0*i3*j3*k3;
		dx_pk[254]=3.0*i3*j4*k2;
		dx_pi[255]=2.0*i1*j5*k3;
		dx_pj[255]=5.0*i2*j4*k3;
		dx_pk[255]=3.0*i2*j5*k2;
		dx_pi[256]=j6*k3;
		dx_pj[256]=6.0*i1*j5*k3;
		dx_pk[256]=3.0*i1*j6*k2;
		dx_pj[257]=7.0*j6*k3;
		dx_pk[257]=3.0*j7*k2;
		dx_pi[258]=6.0*i5*k4;
		dx_pk[258]=4.0*i6*k3;
		dx_pi[259]=5.0*i4*j1*k4;
		dx_pj[259]=i5*k4;
		dx_pk[259]=4.0*i5*j1*k3;
		dx_pi[260]=4.0*i3*j2*k4;
		dx_pj[260]=2.0*i4*j1*k4;
		dx_pk[260]=4.0*i4*j2*k3;
		dx_pi[261]=3.0*i2*j3*k4;
		dx_pj[261]=3.0*i3*j2*k4;
		dx_pk[261]=4.0*i3*j3*k3;
		dx_pi[262]=2.0*i1*j4*k4;
		dx_pj[262]=4.0*i2*j3*k4;
		dx_pk[262]=4.0*i2*j4*k3;
		dx_pi[263]=j5*k4;
		dx_pj[263]=5.0*i1*j4*k4;
		dx_pk[263]=4.0*i1*j5*k3;
		dx_pj[264]=6.0*j5*k4;
		dx_pk[264]=4.0*j6*k3;
		dx_pi[265]=5.0*i4*k5;
		dx_pk[265]=5.0*i5*k4;
		dx_pi[266]=4.0*i3*j1*k5;
		dx_pj[266]=i4*k5;
		dx_pk[266]=5.0*i4*j1*k4;
		dx_pi[267]=3.0*i2*j2*k5;
		dx_pj[267]=2.0*i3*j1*k5;
		dx_pk[267]=5.0*i3*j2*k4;
		dx_pi[268]=2.0*i1*j3*k5;
		dx_pj[268]=3.0*i2*j2*k5;
		dx_pk[268]=5.0*i2*j3*k4;
		dx_pi[269]=j4*k5;
		dx_pj[269]=4.0*i1*j3*k5;
		dx_pk[269]=5.0*i1*j4*k4;
		dx_pj[270]=5.0*j4*k5;
		dx_pk[270]=5.0*j5*k4;
		dx_pi[271]=4.0*i3*k6;
		dx_pk[271]=6.0*i4*k5;
		dx_pi[272]=3.0*i2*j1*k6;
		dx_pj[272]=i3*k6;
		dx_pk[272]=6.0*i3*j1*k5;
		dx_pi[273]=2.0*i1*j2*k6;
		dx_pj[273]=2.0*i2*j1*k6;
		dx_pk[273]=6.0*i2*j2*k5;
		dx_pi[274]=j3*k6;
		dx_pj[274]=3.0*i1*j2*k6;
		dx_pk[274]=6.0*i1*j3*k5;
		dx_pj[275]=4.0*j3*k6;
		dx_pk[275]=6.0*j4*k5;
		dx_pi[276]=3.0*i2*k7;
		dx_pk[276]=7.0*i3*k6;
		dx_pi[277]=2.0*i1*j1*k7;
		dx_pj[277]=i2*k7;
		dx_pk[277]=7.0*i2*j1*k6;
		dx_pi[278]=j2*k7;
		dx_pj[278]=2.0*i1*j1*k7;
		dx_pk[278]=7.0*i1*j2*k6;
		dx_pj[279]=3.0*j2*k7;
		dx_pk[279]=7.0*j3*k6;
		dx_pi[280]=2.0*i1*k8;
		dx_pk[280]=8.0*i2*k7;
		dx_pi[281]=j1*k8;
		dx_pj[281]=i1*k8;
		dx_pk[281]=8.0*i1*j1*k7;
		dx_pj[282]=2.0*j1*k8;
		dx_pk[282]=8.0*j2*k7;
		dx_pi[283]=k9;
		dx_pk[283]=9.0*i1*k8;
		dx_pj[284]=k9;
		dx_pk[284]=9.0*j1*k8;
		dx_pk[285]=10.0*k9;

	if(order>10){
	
		double i11=i10*i1;
		double j11=j10*j1;
		double k11=k10*k1;
		
		dx_pi[286]=11.0*i10;
		dx_pi[287]=10.0*i9*j1;
		dx_pj[287]=i10;
		dx_pi[288]=9.0*i8*j2;
		dx_pj[288]=2.0*i9*j1;
		dx_pi[289]=8.0*i7*j3;
		dx_pj[289]=3.0*i8*j2;
		dx_pi[290]=7.0*i6*j4;
		dx_pj[290]=4.0*i7*j3;
		dx_pi[291]=6.0*i5*j5;
		dx_pj[291]=5.0*i6*j4;
		dx_pi[292]=5.0*i4*j6;
		dx_pj[292]=6.0*i5*j5;
		dx_pi[293]=4.0*i3*j7;
		dx_pj[293]=7.0*i4*j6;
		dx_pi[294]=3.0*i2*j8;
		dx_pj[294]=8.0*i3*j7;
		dx_pi[295]=2.0*i1*j9;
		dx_pj[295]=9.0*i2*j8;
		dx_pi[296]=j10;
		dx_pj[296]=10.0*i1*j9;
		dx_pj[297]=11.0*j10;
		dx_pi[298]=10.0*i9*k1;
		dx_pk[298]=i10;
		dx_pi[299]=9.0*i8*j1*k1;
		dx_pj[299]=i9*k1;
		dx_pk[299]=i9*j1;
		dx_pi[300]=8.0*i7*j2*k1;
		dx_pj[300]=2.0*i8*j1*k1;
		dx_pk[300]=i8*j2;
		dx_pi[301]=7.0*i6*j3*k1;
		dx_pj[301]=3.0*i7*j2*k1;
		dx_pk[301]=i7*j3;
		dx_pi[302]=6.0*i5*j4*k1;
		dx_pj[302]=4.0*i6*j3*k1;
		dx_pk[302]=i6*j4;
		dx_pi[303]=5.0*i4*j5*k1;
		dx_pj[303]=5.0*i5*j4*k1;
		dx_pk[303]=i5*j5;
		dx_pi[304]=4.0*i3*j6*k1;
		dx_pj[304]=6.0*i4*j5*k1;
		dx_pk[304]=i4*j6;
		dx_pi[305]=3.0*i2*j7*k1;
		dx_pj[305]=7.0*i3*j6*k1;
		dx_pk[305]=i3*j7;
		dx_pi[306]=2.0*i1*j8*k1;
		dx_pj[306]=8.0*i2*j7*k1;
		dx_pk[306]=i2*j8;
		dx_pi[307]=j9*k1;
		dx_pj[307]=9.0*i1*j8*k1;
		dx_pk[307]=i1*j9;
		dx_pj[308]=10.0*j9*k1;
		dx_pk[308]=j10;
		dx_pi[309]=9.0*i8*k2;
		dx_pk[309]=2.0*i9*k1;
		dx_pi[310]=8.0*i7*j1*k2;
		dx_pj[310]=i8*k2;
		dx_pk[310]=2.0*i8*j1*k1;
		dx_pi[311]=7.0*i6*j2*k2;
		dx_pj[311]=2.0*i7*j1*k2;
		dx_pk[311]=2.0*i7*j2*k1;
		dx_pi[312]=6.0*i5*j3*k2;
		dx_pj[312]=3.0*i6*j2*k2;
		dx_pk[312]=2.0*i6*j3*k1;
		dx_pi[313]=5.0*i4*j4*k2;
		dx_pj[313]=4.0*i5*j3*k2;
		dx_pk[313]=2.0*i5*j4*k1;
		dx_pi[314]=4.0*i3*j5*k2;
		dx_pj[314]=5.0*i4*j4*k2;
		dx_pk[314]=2.0*i4*j5*k1;
		dx_pi[315]=3.0*i2*j6*k2;
		dx_pj[315]=6.0*i3*j5*k2;
		dx_pk[315]=2.0*i3*j6*k1;
		dx_pi[316]=2.0*i1*j7*k2;
		dx_pj[316]=7.0*i2*j6*k2;
		dx_pk[316]=2.0*i2*j7*k1;
		dx_pi[317]=j8*k2;
		dx_pj[317]=8.0*i1*j7*k2;
		dx_pk[317]=2.0*i1*j8*k1;
		dx_pj[318]=9.0*j8*k2;
		dx_pk[318]=2.0*j9*k1;
		dx_pi[319]=8.0*i7*k3;
		dx_pk[319]=3.0*i8*k2;
		dx_pi[320]=7.0*i6*j1*k3;
		dx_pj[320]=i7*k3;
		dx_pk[320]=3.0*i7*j1*k2;
		dx_pi[321]=6.0*i5*j2*k3;
		dx_pj[321]=2.0*i6*j1*k3;
		dx_pk[321]=3.0*i6*j2*k2;
		dx_pi[322]=5.0*i4*j3*k3;
		dx_pj[322]=3.0*i5*j2*k3;
		dx_pk[322]=3.0*i5*j3*k2;
		dx_pi[323]=4.0*i3*j4*k3;
		dx_pj[323]=4.0*i4*j3*k3;
		dx_pk[323]=3.0*i4*j4*k2;
		dx_pi[324]=3.0*i2*j5*k3;
		dx_pj[324]=5.0*i3*j4*k3;
		dx_pk[324]=3.0*i3*j5*k2;
		dx_pi[325]=2.0*i1*j6*k3;
		dx_pj[325]=6.0*i2*j5*k3;
		dx_pk[325]=3.0*i2*j6*k2;
		dx_pi[326]=j7*k3;
		dx_pj[326]=7.0*i1*j6*k3;
		dx_pk[326]=3.0*i1*j7*k2;
		dx_pj[327]=8.0*j7*k3;
		dx_pk[327]=3.0*j8*k2;
		dx_pi[328]=7.0*i6*k4;
		dx_pk[328]=4.0*i7*k3;
		dx_pi[329]=6.0*i5*j1*k4;
		dx_pj[329]=i6*k4;
		dx_pk[329]=4.0*i6*j1*k3;
		dx_pi[330]=5.0*i4*j2*k4;
		dx_pj[330]=2.0*i5*j1*k4;
		dx_pk[330]=4.0*i5*j2*k3;
		dx_pi[331]=4.0*i3*j3*k4;
		dx_pj[331]=3.0*i4*j2*k4;
		dx_pk[331]=4.0*i4*j3*k3;
		dx_pi[332]=3.0*i2*j4*k4;
		dx_pj[332]=4.0*i3*j3*k4;
		dx_pk[332]=4.0*i3*j4*k3;
		dx_pi[333]=2.0*i1*j5*k4;
		dx_pj[333]=5.0*i2*j4*k4;
		dx_pk[333]=4.0*i2*j5*k3;
		dx_pi[334]=j6*k4;
		dx_pj[334]=6.0*i1*j5*k4;
		dx_pk[334]=4.0*i1*j6*k3;
		dx_pj[335]=7.0*j6*k4;
		dx_pk[335]=4.0*j7*k3;
		dx_pi[336]=6.0*i5*k5;
		dx_pk[336]=5.0*i6*k4;
		dx_pi[337]=5.0*i4*j1*k5;
		dx_pj[337]=i5*k5;
		dx_pk[337]=5.0*i5*j1*k4;
		dx_pi[338]=4.0*i3*j2*k5;
		dx_pj[338]=2.0*i4*j1*k5;
		dx_pk[338]=5.0*i4*j2*k4;
		dx_pi[339]=3.0*i2*j3*k5;
		dx_pj[339]=3.0*i3*j2*k5;
		dx_pk[339]=5.0*i3*j3*k4;
		dx_pi[340]=2.0*i1*j4*k5;
		dx_pj[340]=4.0*i2*j3*k5;
		dx_pk[340]=5.0*i2*j4*k4;
		dx_pi[341]=j5*k5;
		dx_pj[341]=5.0*i1*j4*k5;
		dx_pk[341]=5.0*i1*j5*k4;
		dx_pj[342]=6.0*j5*k5;
		dx_pk[342]=5.0*j6*k4;
		dx_pi[343]=5.0*i4*k6;
		dx_pk[343]=6.0*i5*k5;
		dx_pi[344]=4.0*i3*j1*k6;
		dx_pj[344]=i4*k6;
		dx_pk[344]=6.0*i4*j1*k5;
		dx_pi[345]=3.0*i2*j2*k6;
		dx_pj[345]=2.0*i3*j1*k6;
		dx_pk[345]=6.0*i3*j2*k5;
		dx_pi[346]=2.0*i1*j3*k6;
		dx_pj[346]=3.0*i2*j2*k6;
		dx_pk[346]=6.0*i2*j3*k5;
		dx_pi[347]=j4*k6;
		dx_pj[347]=4.0*i1*j3*k6;
		dx_pk[347]=6.0*i1*j4*k5;
		dx_pj[348]=5.0*j4*k6;
		dx_pk[348]=6.0*j5*k5;
		dx_pi[349]=4.0*i3*k7;
		dx_pk[349]=7.0*i4*k6;
		dx_pi[350]=3.0*i2*j1*k7;
		dx_pj[350]=i3*k7;
		dx_pk[350]=7.0*i3*j1*k6;
		dx_pi[351]=2.0*i1*j2*k7;
		dx_pj[351]=2.0*i2*j1*k7;
		dx_pk[351]=7.0*i2*j2*k6;
		dx_pi[352]=j3*k7;
		dx_pj[352]=3.0*i1*j2*k7;
		dx_pk[352]=7.0*i1*j3*k6;
		dx_pj[353]=4.0*j3*k7;
		dx_pk[353]=7.0*j4*k6;
		dx_pi[354]=3.0*i2*k8;
		dx_pk[354]=8.0*i3*k7;
		dx_pi[355]=2.0*i1*j1*k8;
		dx_pj[355]=i2*k8;
		dx_pk[355]=8.0*i2*j1*k7;
		dx_pi[356]=j2*k8;
		dx_pj[356]=2.0*i1*j1*k8;
		dx_pk[356]=8.0*i1*j2*k7;
		dx_pj[357]=3.0*j2*k8;
		dx_pk[357]=8.0*j3*k7;
		dx_pi[358]=2.0*i1*k9;
		dx_pk[358]=9.0*i2*k8;
		dx_pi[359]=j1*k9;
		dx_pj[359]=i1*k9;
		dx_pk[359]=9.0*i1*j1*k8;
		dx_pj[360]=2.0*j1*k9;
		dx_pk[360]=9.0*j2*k8;
		dx_pi[361]=k10;
		dx_pk[361]=10.0*i1*k9;
		dx_pj[362]=k10;
		dx_pk[362]=10.0*j1*k9;
		dx_pk[363]=11.0*k10;

	if(order>11){
	
		dx_pi[364]=12.0*i11;
		dx_pi[365]=11.0*i10*j1;
		dx_pj[365]=i11;
		dx_pi[366]=10.0*i9*j2;
		dx_pj[366]=2.0*i10*j1;
		dx_pi[367]=9.0*i8*j3;
		dx_pj[367]=3.0*i9*j2;
		dx_pi[368]=8.0*i7*j4;
		dx_pj[368]=4.0*i8*j3;
		dx_pi[369]=7.0*i6*j5;
		dx_pj[369]=5.0*i7*j4;
		dx_pi[370]=6.0*i5*j6;
		dx_pj[370]=6.0*i6*j5;
		dx_pi[371]=5.0*i4*j7;
		dx_pj[371]=7.0*i5*j6;
		dx_pi[372]=4.0*i3*j8;
		dx_pj[372]=8.0*i4*j7;
		dx_pi[373]=3.0*i2*j9;
		dx_pj[373]=9.0*i3*j8;
		dx_pi[374]=2.0*i1*j10;
		dx_pj[374]=10.0*i2*j9;
		dx_pi[375]=j11;
		dx_pj[375]=11.0*i1*j10;
		dx_pj[376]=12.0*j11;
		dx_pi[377]=11.0*i10*k1;
		dx_pk[377]=i11;
		dx_pi[378]=10.0*i9*j1*k1;
		dx_pj[378]=i10*k1;
		dx_pk[378]=i10*j1;
		dx_pi[379]=9.0*i8*j2*k1;
		dx_pj[379]=2.0*i9*j1*k1;
		dx_pk[379]=i9*j2;
		dx_pi[380]=8.0*i7*j3*k1;
		dx_pj[380]=3.0*i8*j2*k1;
		dx_pk[380]=i8*j3;
		dx_pi[381]=7.0*i6*j4*k1;
		dx_pj[381]=4.0*i7*j3*k1;
		dx_pk[381]=i7*j4;
		dx_pi[382]=6.0*i5*j5*k1;
		dx_pj[382]=5.0*i6*j4*k1;
		dx_pk[382]=i6*j5;
		dx_pi[383]=5.0*i4*j6*k1;
		dx_pj[383]=6.0*i5*j5*k1;
		dx_pk[383]=i5*j6;
		dx_pi[384]=4.0*i3*j7*k1;
		dx_pj[384]=7.0*i4*j6*k1;
		dx_pk[384]=i4*j7;
		dx_pi[385]=3.0*i2*j8*k1;
		dx_pj[385]=8.0*i3*j7*k1;
		dx_pk[385]=i3*j8;
		dx_pi[386]=2.0*i1*j9*k1;
		dx_pj[386]=9.0*i2*j8*k1;
		dx_pk[386]=i2*j9;
		dx_pi[387]=j10*k1;
		dx_pj[387]=10.0*i1*j9*k1;
		dx_pk[387]=i1*j10;
		dx_pj[388]=11.0*j10*k1;
		dx_pk[388]=j11;
		dx_pi[389]=10.0*i9*k2;
		dx_pk[389]=2.0*i10*k1;
		dx_pi[390]=9.0*i8*j1*k2;
		dx_pj[390]=i9*k2;
		dx_pk[390]=2.0*i9*j1*k1;
		dx_pi[391]=8.0*i7*j2*k2;
		dx_pj[391]=2.0*i8*j1*k2;
		dx_pk[391]=2.0*i8*j2*k1;
		dx_pi[392]=7.0*i6*j3*k2;
		dx_pj[392]=3.0*i7*j2*k2;
		dx_pk[392]=2.0*i7*j3*k1;
		dx_pi[393]=6.0*i5*j4*k2;
		dx_pj[393]=4.0*i6*j3*k2;
		dx_pk[393]=2.0*i6*j4*k1;
		dx_pi[394]=5.0*i4*j5*k2;
		dx_pj[394]=5.0*i5*j4*k2;
		dx_pk[394]=2.0*i5*j5*k1;
		dx_pi[395]=4.0*i3*j6*k2;
		dx_pj[395]=6.0*i4*j5*k2;
		dx_pk[395]=2.0*i4*j6*k1;
		dx_pi[396]=3.0*i2*j7*k2;
		dx_pj[396]=7.0*i3*j6*k2;
		dx_pk[396]=2.0*i3*j7*k1;
		dx_pi[397]=2.0*i1*j8*k2;
		dx_pj[397]=8.0*i2*j7*k2;
		dx_pk[397]=2.0*i2*j8*k1;
		dx_pi[398]=j9*k2;
		dx_pj[398]=9.0*i1*j8*k2;
		dx_pk[398]=2.0*i1*j9*k1;
		dx_pj[399]=10.0*j9*k2;
		dx_pk[399]=2.0*j10*k1;
		dx_pi[400]=9.0*i8*k3;
		dx_pk[400]=3.0*i9*k2;
		dx_pi[401]=8.0*i7*j1*k3;
		dx_pj[401]=i8*k3;
		dx_pk[401]=3.0*i8*j1*k2;
		dx_pi[402]=7.0*i6*j2*k3;
		dx_pj[402]=2.0*i7*j1*k3;
		dx_pk[402]=3.0*i7*j2*k2;
		dx_pi[403]=6.0*i5*j3*k3;
		dx_pj[403]=3.0*i6*j2*k3;
		dx_pk[403]=3.0*i6*j3*k2;
		dx_pi[404]=5.0*i4*j4*k3;
		dx_pj[404]=4.0*i5*j3*k3;
		dx_pk[404]=3.0*i5*j4*k2;
		dx_pi[405]=4.0*i3*j5*k3;
		dx_pj[405]=5.0*i4*j4*k3;
		dx_pk[405]=3.0*i4*j5*k2;
		dx_pi[406]=3.0*i2*j6*k3;
		dx_pj[406]=6.0*i3*j5*k3;
		dx_pk[406]=3.0*i3*j6*k2;
		dx_pi[407]=2.0*i1*j7*k3;
		dx_pj[407]=7.0*i2*j6*k3;
		dx_pk[407]=3.0*i2*j7*k2;
		dx_pi[408]=j8*k3;
		dx_pj[408]=8.0*i1*j7*k3;
		dx_pk[408]=3.0*i1*j8*k2;
		dx_pj[409]=9.0*j8*k3;
		dx_pk[409]=3.0*j9*k2;
		dx_pi[410]=8.0*i7*k4;
		dx_pk[410]=4.0*i8*k3;
		dx_pi[411]=7.0*i6*j1*k4;
		dx_pj[411]=i7*k4;
		dx_pk[411]=4.0*i7*j1*k3;
		dx_pi[412]=6.0*i5*j2*k4;
		dx_pj[412]=2.0*i6*j1*k4;
		dx_pk[412]=4.0*i6*j2*k3;
		dx_pi[413]=5.0*i4*j3*k4;
		dx_pj[413]=3.0*i5*j2*k4;
		dx_pk[413]=4.0*i5*j3*k3;
		dx_pi[414]=4.0*i3*j4*k4;
		dx_pj[414]=4.0*i4*j3*k4;
		dx_pk[414]=4.0*i4*j4*k3;
		dx_pi[415]=3.0*i2*j5*k4;
		dx_pj[415]=5.0*i3*j4*k4;
		dx_pk[415]=4.0*i3*j5*k3;
		dx_pi[416]=2.0*i1*j6*k4;
		dx_pj[416]=6.0*i2*j5*k4;
		dx_pk[416]=4.0*i2*j6*k3;
		dx_pi[417]=j7*k4;
		dx_pj[417]=7.0*i1*j6*k4;
		dx_pk[417]=4.0*i1*j7*k3;
		dx_pj[418]=8.0*j7*k4;
		dx_pk[418]=4.0*j8*k3;
		dx_pi[419]=7.0*i6*k5;
		dx_pk[419]=5.0*i7*k4;
		dx_pi[420]=6.0*i5*j1*k5;
		dx_pj[420]=i6*k5;
		dx_pk[420]=5.0*i6*j1*k4;
		dx_pi[421]=5.0*i4*j2*k5;
		dx_pj[421]=2.0*i5*j1*k5;
		dx_pk[421]=5.0*i5*j2*k4;
		dx_pi[422]=4.0*i3*j3*k5;
		dx_pj[422]=3.0*i4*j2*k5;
		dx_pk[422]=5.0*i4*j3*k4;
		dx_pi[423]=3.0*i2*j4*k5;
		dx_pj[423]=4.0*i3*j3*k5;
		dx_pk[423]=5.0*i3*j4*k4;
		dx_pi[424]=2.0*i1*j5*k5;
		dx_pj[424]=5.0*i2*j4*k5;
		dx_pk[424]=5.0*i2*j5*k4;
		dx_pi[425]=j6*k5;
		dx_pj[425]=6.0*i1*j5*k5;
		dx_pk[425]=5.0*i1*j6*k4;
		dx_pj[426]=7.0*j6*k5;
		dx_pk[426]=5.0*j7*k4;
		dx_pi[427]=6.0*i5*k6;
		dx_pk[427]=6.0*i6*k5;
		dx_pi[428]=5.0*i4*j1*k6;
		dx_pj[428]=i5*k6;
		dx_pk[428]=6.0*i5*j1*k5;
		dx_pi[429]=4.0*i3*j2*k6;
		dx_pj[429]=2.0*i4*j1*k6;
		dx_pk[429]=6.0*i4*j2*k5;
		dx_pi[430]=3.0*i2*j3*k6;
		dx_pj[430]=3.0*i3*j2*k6;
		dx_pk[430]=6.0*i3*j3*k5;
		dx_pi[431]=2.0*i1*j4*k6;
		dx_pj[431]=4.0*i2*j3*k6;
		dx_pk[431]=6.0*i2*j4*k5;
		dx_pi[432]=j5*k6;
		dx_pj[432]=5.0*i1*j4*k6;
		dx_pk[432]=6.0*i1*j5*k5;
		dx_pj[433]=6.0*j5*k6;
		dx_pk[433]=6.0*j6*k5;
		dx_pi[434]=5.0*i4*k7;
		dx_pk[434]=7.0*i5*k6;
		dx_pi[435]=4.0*i3*j1*k7;
		dx_pj[435]=i4*k7;
		dx_pk[435]=7.0*i4*j1*k6;
		dx_pi[436]=3.0*i2*j2*k7;
		dx_pj[436]=2.0*i3*j1*k7;
		dx_pk[436]=7.0*i3*j2*k6;
		dx_pi[437]=2.0*i1*j3*k7;
		dx_pj[437]=3.0*i2*j2*k7;
		dx_pk[437]=7.0*i2*j3*k6;
		dx_pi[438]=j4*k7;
		dx_pj[438]=4.0*i1*j3*k7;
		dx_pk[438]=7.0*i1*j4*k6;
		dx_pj[439]=5.0*j4*k7;
		dx_pk[439]=7.0*j5*k6;
		dx_pi[440]=4.0*i3*k8;
		dx_pk[440]=8.0*i4*k7;
		dx_pi[441]=3.0*i2*j1*k8;
		dx_pj[441]=i3*k8;
		dx_pk[441]=8.0*i3*j1*k7;
		dx_pi[442]=2.0*i1*j2*k8;
		dx_pj[442]=2.0*i2*j1*k8;
		dx_pk[442]=8.0*i2*j2*k7;
		dx_pi[443]=j3*k8;
		dx_pj[443]=3.0*i1*j2*k8;
		dx_pk[443]=8.0*i1*j3*k7;
		dx_pj[444]=4.0*j3*k8;
		dx_pk[444]=8.0*j4*k7;
		dx_pi[445]=3.0*i2*k9;
		dx_pk[445]=9.0*i3*k8;
		dx_pi[446]=2.0*i1*j1*k9;
		dx_pj[446]=i2*k9;
		dx_pk[446]=9.0*i2*j1*k8;
		dx_pi[447]=j2*k9;
		dx_pj[447]=2.0*i1*j1*k9;
		dx_pk[447]=9.0*i1*j2*k8;
		dx_pj[448]=3.0*j2*k9;
		dx_pk[448]=9.0*j3*k8;
		dx_pi[449]=2.0*i1*k10;
		dx_pk[449]=10.0*i2*k9;
		dx_pi[450]=j1*k10;
		dx_pj[450]=i1*k10;
		dx_pk[450]=10.0*i1*j1*k9;
		dx_pj[451]=2.0*j1*k10;
		dx_pk[451]=10.0*j2*k9;
		dx_pi[452]=k11;
		dx_pk[452]=11.0*i1*k10;
		dx_pj[453]=k11;
		dx_pk[453]=11.0*j1*k10;
		dx_pk[454]=12.0*k11;
	} /* End (if order>11) */
	} /* End (if order>10) */
	} /* End (if order>9) */
	} /* End (if order>8) */
	} /* End (if order>7) */
	} /* End (if order>6) */
	} /* End (if order>5) */
	} /* End (if order>4) */
	} /* End (if order>3) */
	} /* End (if order>2) */
	} /* End (if order>1) */
	} /* End (if order>0) */



	/* Find the x coordinate */
	{
		double dx_i=0.0;
		double dy_i=0.0;
		double dz_i=0.0;
		double dx_j=0.0;
		double dy_j=0.0;
		double dz_j=0.0;
		double dx_k=0.0;
		double dy_k=0.0;
		double dz_k=0.0;
		
		{
			double *p0=es[0];
			double *p1=es[1];
			double *p2=es[2];
			
			double *pi=dx_pi;
			double *pj=dx_pj;
			double *pk=dx_pk;
			
			unsigned int ii;
			
			for(ii=0;ii<coeffp;ii++){
				
				dx_i+=*p0**pi;
				dy_i+=*p1**pi;
				dz_i+=*p2**pi++;
				dx_j+=*p0**pj;
				dy_j+=*p1**pj;
				dz_j+=*p2**pj++;
				dx_k+=*p0++**pk;
				dy_k+=*p1++**pk;
				dz_k+=*p2++**pk++;
			}
		}

		/* Do not assume that ed is only 3x3 */
		ed[0][0]=dx_i;
		ed[1][0]=dx_j;
		ed[2][0]=dx_k;
		ed[0][1]=dy_i;
		ed[1][1]=dy_j;
		ed[2][1]=dy_k;
		ed[0][2]=dz_i;
		ed[1][2]=dz_j;
		ed[2][2]=dz_k;
	}
	return 0;
}
