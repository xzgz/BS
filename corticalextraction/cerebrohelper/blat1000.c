/* Copyright 1998-2001 Roger P. Woods, M.D. */
/* Modified 5/16/01 */

/*
 *
 * This routine will combine a 12 parameter affine transform with a
 *  nonlinear transform, thereby altering the standard file's identity
 *
 * Returns 0 if successful, error code otherwise
 */

#include "AIR.h"
#define	COORDS_INT 3

static void free_function(/*@only@*/double **out, /*@only@*/double *work1, /*@only@*/double *work2)

{
	if(out) AIR_free_2(out);
	if(work1) free(work1);
	if(work2) free(work2);
}

static void by3(double *a, double *b, double *c, unsigned int order)

{
	unsigned int coeffp=(order+1)*(order+2)*(order+3)/6;
	{
		unsigned int i;
		double *cptr=c;
		
		for(i=coeffp;i--!=0;){
			*cptr++=0.0;
		}
	}

	if(order!=0){

		c[0]+=a[0]*b[0];

		c[1]+=a[1]*b[0];

		c[2]+=a[2]*b[0];

		c[3]+=a[3]*b[0];

	if(order>1){

		c[1]+=a[0]*b[1];
		c[2]+=a[0]*b[2];
		c[3]+=a[0]*b[3];

		c[4]+=a[1]*b[1];
		c[5]+=a[1]*b[2];
		c[7]+=a[1]*b[3];

		c[5]+=a[2]*b[1];
		c[6]+=a[2]*b[2];
		c[8]+=a[2]*b[3];

		c[7]+=a[3]*b[1];
		c[8]+=a[3]*b[2];
		c[9]+=a[3]*b[3];

	if(order>2){

		c[4]+=a[0]*b[4];
		c[5]+=a[0]*b[5];
		c[6]+=a[0]*b[6];
		c[7]+=a[0]*b[7];
		c[8]+=a[0]*b[8];
		c[9]+=a[0]*b[9];

		c[10]+=a[1]*b[4];
		c[11]+=a[1]*b[5];
		c[12]+=a[1]*b[6];
		c[14]+=a[1]*b[7];
		c[15]+=a[1]*b[8];
		c[17]+=a[1]*b[9];

		c[11]+=a[2]*b[4];
		c[12]+=a[2]*b[5];
		c[13]+=a[2]*b[6];
		c[15]+=a[2]*b[7];
		c[16]+=a[2]*b[8];
		c[18]+=a[2]*b[9];

		c[14]+=a[3]*b[4];
		c[15]+=a[3]*b[5];
		c[16]+=a[3]*b[6];
		c[17]+=a[3]*b[7];
		c[18]+=a[3]*b[8];
		c[19]+=a[3]*b[9];

	if(order>3){

		c[10]+=a[0]*b[10];
		c[11]+=a[0]*b[11];
		c[12]+=a[0]*b[12];
		c[13]+=a[0]*b[13];
		c[14]+=a[0]*b[14];
		c[15]+=a[0]*b[15];
		c[16]+=a[0]*b[16];
		c[17]+=a[0]*b[17];
		c[18]+=a[0]*b[18];
		c[19]+=a[0]*b[19];

		c[20]+=a[1]*b[10];
		c[21]+=a[1]*b[11];
		c[22]+=a[1]*b[12];
		c[23]+=a[1]*b[13];
		c[25]+=a[1]*b[14];
		c[26]+=a[1]*b[15];
		c[27]+=a[1]*b[16];
		c[29]+=a[1]*b[17];
		c[30]+=a[1]*b[18];
		c[32]+=a[1]*b[19];

		c[21]+=a[2]*b[10];
		c[22]+=a[2]*b[11];
		c[23]+=a[2]*b[12];
		c[24]+=a[2]*b[13];
		c[26]+=a[2]*b[14];
		c[27]+=a[2]*b[15];
		c[28]+=a[2]*b[16];
		c[30]+=a[2]*b[17];
		c[31]+=a[2]*b[18];
		c[33]+=a[2]*b[19];

		c[25]+=a[3]*b[10];
		c[26]+=a[3]*b[11];
		c[27]+=a[3]*b[12];
		c[28]+=a[3]*b[13];
		c[29]+=a[3]*b[14];
		c[30]+=a[3]*b[15];
		c[31]+=a[3]*b[16];
		c[32]+=a[3]*b[17];
		c[33]+=a[3]*b[18];
		c[34]+=a[3]*b[19];

	if(order>4){

		c[20]+=a[0]*b[20];
		c[21]+=a[0]*b[21];
		c[22]+=a[0]*b[22];
		c[23]+=a[0]*b[23];
		c[24]+=a[0]*b[24];
		c[25]+=a[0]*b[25];
		c[26]+=a[0]*b[26];
		c[27]+=a[0]*b[27];
		c[28]+=a[0]*b[28];
		c[29]+=a[0]*b[29];
		c[30]+=a[0]*b[30];
		c[31]+=a[0]*b[31];
		c[32]+=a[0]*b[32];
		c[33]+=a[0]*b[33];
		c[34]+=a[0]*b[34];

		c[35]+=a[1]*b[20];
		c[36]+=a[1]*b[21];
		c[37]+=a[1]*b[22];
		c[38]+=a[1]*b[23];
		c[39]+=a[1]*b[24];
		c[41]+=a[1]*b[25];
		c[42]+=a[1]*b[26];
		c[43]+=a[1]*b[27];
		c[44]+=a[1]*b[28];
		c[46]+=a[1]*b[29];
		c[47]+=a[1]*b[30];
		c[48]+=a[1]*b[31];
		c[50]+=a[1]*b[32];
		c[51]+=a[1]*b[33];
		c[53]+=a[1]*b[34];

		c[36]+=a[2]*b[20];
		c[37]+=a[2]*b[21];
		c[38]+=a[2]*b[22];
		c[39]+=a[2]*b[23];
		c[40]+=a[2]*b[24];
		c[42]+=a[2]*b[25];
		c[43]+=a[2]*b[26];
		c[44]+=a[2]*b[27];
		c[45]+=a[2]*b[28];
		c[47]+=a[2]*b[29];
		c[48]+=a[2]*b[30];
		c[49]+=a[2]*b[31];
		c[51]+=a[2]*b[32];
		c[52]+=a[2]*b[33];
		c[54]+=a[2]*b[34];

		c[41]+=a[3]*b[20];
		c[42]+=a[3]*b[21];
		c[43]+=a[3]*b[22];
		c[44]+=a[3]*b[23];
		c[45]+=a[3]*b[24];
		c[46]+=a[3]*b[25];
		c[47]+=a[3]*b[26];
		c[48]+=a[3]*b[27];
		c[49]+=a[3]*b[28];
		c[50]+=a[3]*b[29];
		c[51]+=a[3]*b[30];
		c[52]+=a[3]*b[31];
		c[53]+=a[3]*b[32];
		c[54]+=a[3]*b[33];
		c[55]+=a[3]*b[34];

	if(order>5){

		c[35]+=a[0]*b[35];
		c[36]+=a[0]*b[36];
		c[37]+=a[0]*b[37];
		c[38]+=a[0]*b[38];
		c[39]+=a[0]*b[39];
		c[40]+=a[0]*b[40];
		c[41]+=a[0]*b[41];
		c[42]+=a[0]*b[42];
		c[43]+=a[0]*b[43];
		c[44]+=a[0]*b[44];
		c[45]+=a[0]*b[45];
		c[46]+=a[0]*b[46];
		c[47]+=a[0]*b[47];
		c[48]+=a[0]*b[48];
		c[49]+=a[0]*b[49];
		c[50]+=a[0]*b[50];
		c[51]+=a[0]*b[51];
		c[52]+=a[0]*b[52];
		c[53]+=a[0]*b[53];
		c[54]+=a[0]*b[54];
		c[55]+=a[0]*b[55];

		c[56]+=a[1]*b[35];
		c[57]+=a[1]*b[36];
		c[58]+=a[1]*b[37];
		c[59]+=a[1]*b[38];
		c[60]+=a[1]*b[39];
		c[61]+=a[1]*b[40];
		c[63]+=a[1]*b[41];
		c[64]+=a[1]*b[42];
		c[65]+=a[1]*b[43];
		c[66]+=a[1]*b[44];
		c[67]+=a[1]*b[45];
		c[69]+=a[1]*b[46];
		c[70]+=a[1]*b[47];
		c[71]+=a[1]*b[48];
		c[72]+=a[1]*b[49];
		c[74]+=a[1]*b[50];
		c[75]+=a[1]*b[51];
		c[76]+=a[1]*b[52];
		c[78]+=a[1]*b[53];
		c[79]+=a[1]*b[54];
		c[81]+=a[1]*b[55];

		c[57]+=a[2]*b[35];
		c[58]+=a[2]*b[36];
		c[59]+=a[2]*b[37];
		c[60]+=a[2]*b[38];
		c[61]+=a[2]*b[39];
		c[62]+=a[2]*b[40];
		c[64]+=a[2]*b[41];
		c[65]+=a[2]*b[42];
		c[66]+=a[2]*b[43];
		c[67]+=a[2]*b[44];
		c[68]+=a[2]*b[45];
		c[70]+=a[2]*b[46];
		c[71]+=a[2]*b[47];
		c[72]+=a[2]*b[48];
		c[73]+=a[2]*b[49];
		c[75]+=a[2]*b[50];
		c[76]+=a[2]*b[51];
		c[77]+=a[2]*b[52];
		c[79]+=a[2]*b[53];
		c[80]+=a[2]*b[54];
		c[82]+=a[2]*b[55];

		c[63]+=a[3]*b[35];
		c[64]+=a[3]*b[36];
		c[65]+=a[3]*b[37];
		c[66]+=a[3]*b[38];
		c[67]+=a[3]*b[39];
		c[68]+=a[3]*b[40];
		c[69]+=a[3]*b[41];
		c[70]+=a[3]*b[42];
		c[71]+=a[3]*b[43];
		c[72]+=a[3]*b[44];
		c[73]+=a[3]*b[45];
		c[74]+=a[3]*b[46];
		c[75]+=a[3]*b[47];
		c[76]+=a[3]*b[48];
		c[77]+=a[3]*b[49];
		c[78]+=a[3]*b[50];
		c[79]+=a[3]*b[51];
		c[80]+=a[3]*b[52];
		c[81]+=a[3]*b[53];
		c[82]+=a[3]*b[54];
		c[83]+=a[3]*b[55];

	if(order>6){

		c[56]+=a[0]*b[56];
		c[57]+=a[0]*b[57];
		c[58]+=a[0]*b[58];
		c[59]+=a[0]*b[59];
		c[60]+=a[0]*b[60];
		c[61]+=a[0]*b[61];
		c[62]+=a[0]*b[62];
		c[63]+=a[0]*b[63];
		c[64]+=a[0]*b[64];
		c[65]+=a[0]*b[65];
		c[66]+=a[0]*b[66];
		c[67]+=a[0]*b[67];
		c[68]+=a[0]*b[68];
		c[69]+=a[0]*b[69];
		c[70]+=a[0]*b[70];
		c[71]+=a[0]*b[71];
		c[72]+=a[0]*b[72];
		c[73]+=a[0]*b[73];
		c[74]+=a[0]*b[74];
		c[75]+=a[0]*b[75];
		c[76]+=a[0]*b[76];
		c[77]+=a[0]*b[77];
		c[78]+=a[0]*b[78];
		c[79]+=a[0]*b[79];
		c[80]+=a[0]*b[80];
		c[81]+=a[0]*b[81];
		c[82]+=a[0]*b[82];
		c[83]+=a[0]*b[83];

		c[84]+=a[1]*b[56];
		c[85]+=a[1]*b[57];
		c[86]+=a[1]*b[58];
		c[87]+=a[1]*b[59];
		c[88]+=a[1]*b[60];
		c[89]+=a[1]*b[61];
		c[90]+=a[1]*b[62];
		c[92]+=a[1]*b[63];
		c[93]+=a[1]*b[64];
		c[94]+=a[1]*b[65];
		c[95]+=a[1]*b[66];
		c[96]+=a[1]*b[67];
		c[97]+=a[1]*b[68];
		c[99]+=a[1]*b[69];
		c[100]+=a[1]*b[70];
		c[101]+=a[1]*b[71];
		c[102]+=a[1]*b[72];
		c[103]+=a[1]*b[73];
		c[105]+=a[1]*b[74];
		c[106]+=a[1]*b[75];
		c[107]+=a[1]*b[76];
		c[108]+=a[1]*b[77];
		c[110]+=a[1]*b[78];
		c[111]+=a[1]*b[79];
		c[112]+=a[1]*b[80];
		c[114]+=a[1]*b[81];
		c[115]+=a[1]*b[82];
		c[117]+=a[1]*b[83];

		c[85]+=a[2]*b[56];
		c[86]+=a[2]*b[57];
		c[87]+=a[2]*b[58];
		c[88]+=a[2]*b[59];
		c[89]+=a[2]*b[60];
		c[90]+=a[2]*b[61];
		c[91]+=a[2]*b[62];
		c[93]+=a[2]*b[63];
		c[94]+=a[2]*b[64];
		c[95]+=a[2]*b[65];
		c[96]+=a[2]*b[66];
		c[97]+=a[2]*b[67];
		c[98]+=a[2]*b[68];
		c[100]+=a[2]*b[69];
		c[101]+=a[2]*b[70];
		c[102]+=a[2]*b[71];
		c[103]+=a[2]*b[72];
		c[104]+=a[2]*b[73];
		c[106]+=a[2]*b[74];
		c[107]+=a[2]*b[75];
		c[108]+=a[2]*b[76];
		c[109]+=a[2]*b[77];
		c[111]+=a[2]*b[78];
		c[112]+=a[2]*b[79];
		c[113]+=a[2]*b[80];
		c[115]+=a[2]*b[81];
		c[116]+=a[2]*b[82];
		c[118]+=a[2]*b[83];

		c[92]+=a[3]*b[56];
		c[93]+=a[3]*b[57];
		c[94]+=a[3]*b[58];
		c[95]+=a[3]*b[59];
		c[96]+=a[3]*b[60];
		c[97]+=a[3]*b[61];
		c[98]+=a[3]*b[62];
		c[99]+=a[3]*b[63];
		c[100]+=a[3]*b[64];
		c[101]+=a[3]*b[65];
		c[102]+=a[3]*b[66];
		c[103]+=a[3]*b[67];
		c[104]+=a[3]*b[68];
		c[105]+=a[3]*b[69];
		c[106]+=a[3]*b[70];
		c[107]+=a[3]*b[71];
		c[108]+=a[3]*b[72];
		c[109]+=a[3]*b[73];
		c[110]+=a[3]*b[74];
		c[111]+=a[3]*b[75];
		c[112]+=a[3]*b[76];
		c[113]+=a[3]*b[77];
		c[114]+=a[3]*b[78];
		c[115]+=a[3]*b[79];
		c[116]+=a[3]*b[80];
		c[117]+=a[3]*b[81];
		c[118]+=a[3]*b[82];
		c[119]+=a[3]*b[83];

	if(order>7){

		c[84]+=a[0]*b[84];
		c[85]+=a[0]*b[85];
		c[86]+=a[0]*b[86];
		c[87]+=a[0]*b[87];
		c[88]+=a[0]*b[88];
		c[89]+=a[0]*b[89];
		c[90]+=a[0]*b[90];
		c[91]+=a[0]*b[91];
		c[92]+=a[0]*b[92];
		c[93]+=a[0]*b[93];
		c[94]+=a[0]*b[94];
		c[95]+=a[0]*b[95];
		c[96]+=a[0]*b[96];
		c[97]+=a[0]*b[97];
		c[98]+=a[0]*b[98];
		c[99]+=a[0]*b[99];
		c[100]+=a[0]*b[100];
		c[101]+=a[0]*b[101];
		c[102]+=a[0]*b[102];
		c[103]+=a[0]*b[103];
		c[104]+=a[0]*b[104];
		c[105]+=a[0]*b[105];
		c[106]+=a[0]*b[106];
		c[107]+=a[0]*b[107];
		c[108]+=a[0]*b[108];
		c[109]+=a[0]*b[109];
		c[110]+=a[0]*b[110];
		c[111]+=a[0]*b[111];
		c[112]+=a[0]*b[112];
		c[113]+=a[0]*b[113];
		c[114]+=a[0]*b[114];
		c[115]+=a[0]*b[115];
		c[116]+=a[0]*b[116];
		c[117]+=a[0]*b[117];
		c[118]+=a[0]*b[118];
		c[119]+=a[0]*b[119];

		c[120]+=a[1]*b[84];
		c[121]+=a[1]*b[85];
		c[122]+=a[1]*b[86];
		c[123]+=a[1]*b[87];
		c[124]+=a[1]*b[88];
		c[125]+=a[1]*b[89];
		c[126]+=a[1]*b[90];
		c[127]+=a[1]*b[91];
		c[129]+=a[1]*b[92];
		c[130]+=a[1]*b[93];
		c[131]+=a[1]*b[94];
		c[132]+=a[1]*b[95];
		c[133]+=a[1]*b[96];
		c[134]+=a[1]*b[97];
		c[135]+=a[1]*b[98];
		c[137]+=a[1]*b[99];
		c[138]+=a[1]*b[100];
		c[139]+=a[1]*b[101];
		c[140]+=a[1]*b[102];
		c[141]+=a[1]*b[103];
		c[142]+=a[1]*b[104];
		c[144]+=a[1]*b[105];
		c[145]+=a[1]*b[106];
		c[146]+=a[1]*b[107];
		c[147]+=a[1]*b[108];
		c[148]+=a[1]*b[109];
		c[150]+=a[1]*b[110];
		c[151]+=a[1]*b[111];
		c[152]+=a[1]*b[112];
		c[153]+=a[1]*b[113];
		c[155]+=a[1]*b[114];
		c[156]+=a[1]*b[115];
		c[157]+=a[1]*b[116];
		c[159]+=a[1]*b[117];
		c[160]+=a[1]*b[118];
		c[162]+=a[1]*b[119];

		c[121]+=a[2]*b[84];
		c[122]+=a[2]*b[85];
		c[123]+=a[2]*b[86];
		c[124]+=a[2]*b[87];
		c[125]+=a[2]*b[88];
		c[126]+=a[2]*b[89];
		c[127]+=a[2]*b[90];
		c[128]+=a[2]*b[91];
		c[130]+=a[2]*b[92];
		c[131]+=a[2]*b[93];
		c[132]+=a[2]*b[94];
		c[133]+=a[2]*b[95];
		c[134]+=a[2]*b[96];
		c[135]+=a[2]*b[97];
		c[136]+=a[2]*b[98];
		c[138]+=a[2]*b[99];
		c[139]+=a[2]*b[100];
		c[140]+=a[2]*b[101];
		c[141]+=a[2]*b[102];
		c[142]+=a[2]*b[103];
		c[143]+=a[2]*b[104];
		c[145]+=a[2]*b[105];
		c[146]+=a[2]*b[106];
		c[147]+=a[2]*b[107];
		c[148]+=a[2]*b[108];
		c[149]+=a[2]*b[109];
		c[151]+=a[2]*b[110];
		c[152]+=a[2]*b[111];
		c[153]+=a[2]*b[112];
		c[154]+=a[2]*b[113];
		c[156]+=a[2]*b[114];
		c[157]+=a[2]*b[115];
		c[158]+=a[2]*b[116];
		c[160]+=a[2]*b[117];
		c[161]+=a[2]*b[118];
		c[163]+=a[2]*b[119];

		c[129]+=a[3]*b[84];
		c[130]+=a[3]*b[85];
		c[131]+=a[3]*b[86];
		c[132]+=a[3]*b[87];
		c[133]+=a[3]*b[88];
		c[134]+=a[3]*b[89];
		c[135]+=a[3]*b[90];
		c[136]+=a[3]*b[91];
		c[137]+=a[3]*b[92];
		c[138]+=a[3]*b[93];
		c[139]+=a[3]*b[94];
		c[140]+=a[3]*b[95];
		c[141]+=a[3]*b[96];
		c[142]+=a[3]*b[97];
		c[143]+=a[3]*b[98];
		c[144]+=a[3]*b[99];
		c[145]+=a[3]*b[100];
		c[146]+=a[3]*b[101];
		c[147]+=a[3]*b[102];
		c[148]+=a[3]*b[103];
		c[149]+=a[3]*b[104];
		c[150]+=a[3]*b[105];
		c[151]+=a[3]*b[106];
		c[152]+=a[3]*b[107];
		c[153]+=a[3]*b[108];
		c[154]+=a[3]*b[109];
		c[155]+=a[3]*b[110];
		c[156]+=a[3]*b[111];
		c[157]+=a[3]*b[112];
		c[158]+=a[3]*b[113];
		c[159]+=a[3]*b[114];
		c[160]+=a[3]*b[115];
		c[161]+=a[3]*b[116];
		c[162]+=a[3]*b[117];
		c[163]+=a[3]*b[118];
		c[164]+=a[3]*b[119];

	if(order>8){

		c[120]+=a[0]*b[120];
		c[121]+=a[0]*b[121];
		c[122]+=a[0]*b[122];
		c[123]+=a[0]*b[123];
		c[124]+=a[0]*b[124];
		c[125]+=a[0]*b[125];
		c[126]+=a[0]*b[126];
		c[127]+=a[0]*b[127];
		c[128]+=a[0]*b[128];
		c[129]+=a[0]*b[129];
		c[130]+=a[0]*b[130];
		c[131]+=a[0]*b[131];
		c[132]+=a[0]*b[132];
		c[133]+=a[0]*b[133];
		c[134]+=a[0]*b[134];
		c[135]+=a[0]*b[135];
		c[136]+=a[0]*b[136];
		c[137]+=a[0]*b[137];
		c[138]+=a[0]*b[138];
		c[139]+=a[0]*b[139];
		c[140]+=a[0]*b[140];
		c[141]+=a[0]*b[141];
		c[142]+=a[0]*b[142];
		c[143]+=a[0]*b[143];
		c[144]+=a[0]*b[144];
		c[145]+=a[0]*b[145];
		c[146]+=a[0]*b[146];
		c[147]+=a[0]*b[147];
		c[148]+=a[0]*b[148];
		c[149]+=a[0]*b[149];
		c[150]+=a[0]*b[150];
		c[151]+=a[0]*b[151];
		c[152]+=a[0]*b[152];
		c[153]+=a[0]*b[153];
		c[154]+=a[0]*b[154];
		c[155]+=a[0]*b[155];
		c[156]+=a[0]*b[156];
		c[157]+=a[0]*b[157];
		c[158]+=a[0]*b[158];
		c[159]+=a[0]*b[159];
		c[160]+=a[0]*b[160];
		c[161]+=a[0]*b[161];
		c[162]+=a[0]*b[162];
		c[163]+=a[0]*b[163];
		c[164]+=a[0]*b[164];

		c[165]+=a[1]*b[120];
		c[166]+=a[1]*b[121];
		c[167]+=a[1]*b[122];
		c[168]+=a[1]*b[123];
		c[169]+=a[1]*b[124];
		c[170]+=a[1]*b[125];
		c[171]+=a[1]*b[126];
		c[172]+=a[1]*b[127];
		c[173]+=a[1]*b[128];
		c[175]+=a[1]*b[129];
		c[176]+=a[1]*b[130];
		c[177]+=a[1]*b[131];
		c[178]+=a[1]*b[132];
		c[179]+=a[1]*b[133];
		c[180]+=a[1]*b[134];
		c[181]+=a[1]*b[135];
		c[182]+=a[1]*b[136];
		c[184]+=a[1]*b[137];
		c[185]+=a[1]*b[138];
		c[186]+=a[1]*b[139];
		c[187]+=a[1]*b[140];
		c[188]+=a[1]*b[141];
		c[189]+=a[1]*b[142];
		c[190]+=a[1]*b[143];
		c[192]+=a[1]*b[144];
		c[193]+=a[1]*b[145];
		c[194]+=a[1]*b[146];
		c[195]+=a[1]*b[147];
		c[196]+=a[1]*b[148];
		c[197]+=a[1]*b[149];
		c[199]+=a[1]*b[150];
		c[200]+=a[1]*b[151];
		c[201]+=a[1]*b[152];
		c[202]+=a[1]*b[153];
		c[203]+=a[1]*b[154];
		c[205]+=a[1]*b[155];
		c[206]+=a[1]*b[156];
		c[207]+=a[1]*b[157];
		c[208]+=a[1]*b[158];
		c[210]+=a[1]*b[159];
		c[211]+=a[1]*b[160];
		c[212]+=a[1]*b[161];
		c[214]+=a[1]*b[162];
		c[215]+=a[1]*b[163];
		c[217]+=a[1]*b[164];

		c[166]+=a[2]*b[120];
		c[167]+=a[2]*b[121];
		c[168]+=a[2]*b[122];
		c[169]+=a[2]*b[123];
		c[170]+=a[2]*b[124];
		c[171]+=a[2]*b[125];
		c[172]+=a[2]*b[126];
		c[173]+=a[2]*b[127];
		c[174]+=a[2]*b[128];
		c[176]+=a[2]*b[129];
		c[177]+=a[2]*b[130];
		c[178]+=a[2]*b[131];
		c[179]+=a[2]*b[132];
		c[180]+=a[2]*b[133];
		c[181]+=a[2]*b[134];
		c[182]+=a[2]*b[135];
		c[183]+=a[2]*b[136];
		c[185]+=a[2]*b[137];
		c[186]+=a[2]*b[138];
		c[187]+=a[2]*b[139];
		c[188]+=a[2]*b[140];
		c[189]+=a[2]*b[141];
		c[190]+=a[2]*b[142];
		c[191]+=a[2]*b[143];
		c[193]+=a[2]*b[144];
		c[194]+=a[2]*b[145];
		c[195]+=a[2]*b[146];
		c[196]+=a[2]*b[147];
		c[197]+=a[2]*b[148];
		c[198]+=a[2]*b[149];
		c[200]+=a[2]*b[150];
		c[201]+=a[2]*b[151];
		c[202]+=a[2]*b[152];
		c[203]+=a[2]*b[153];
		c[204]+=a[2]*b[154];
		c[206]+=a[2]*b[155];
		c[207]+=a[2]*b[156];
		c[208]+=a[2]*b[157];
		c[209]+=a[2]*b[158];
		c[211]+=a[2]*b[159];
		c[212]+=a[2]*b[160];
		c[213]+=a[2]*b[161];
		c[215]+=a[2]*b[162];
		c[216]+=a[2]*b[163];
		c[218]+=a[2]*b[164];

		c[175]+=a[3]*b[120];
		c[176]+=a[3]*b[121];
		c[177]+=a[3]*b[122];
		c[178]+=a[3]*b[123];
		c[179]+=a[3]*b[124];
		c[180]+=a[3]*b[125];
		c[181]+=a[3]*b[126];
		c[182]+=a[3]*b[127];
		c[183]+=a[3]*b[128];
		c[184]+=a[3]*b[129];
		c[185]+=a[3]*b[130];
		c[186]+=a[3]*b[131];
		c[187]+=a[3]*b[132];
		c[188]+=a[3]*b[133];
		c[189]+=a[3]*b[134];
		c[190]+=a[3]*b[135];
		c[191]+=a[3]*b[136];
		c[192]+=a[3]*b[137];
		c[193]+=a[3]*b[138];
		c[194]+=a[3]*b[139];
		c[195]+=a[3]*b[140];
		c[196]+=a[3]*b[141];
		c[197]+=a[3]*b[142];
		c[198]+=a[3]*b[143];
		c[199]+=a[3]*b[144];
		c[200]+=a[3]*b[145];
		c[201]+=a[3]*b[146];
		c[202]+=a[3]*b[147];
		c[203]+=a[3]*b[148];
		c[204]+=a[3]*b[149];
		c[205]+=a[3]*b[150];
		c[206]+=a[3]*b[151];
		c[207]+=a[3]*b[152];
		c[208]+=a[3]*b[153];
		c[209]+=a[3]*b[154];
		c[210]+=a[3]*b[155];
		c[211]+=a[3]*b[156];
		c[212]+=a[3]*b[157];
		c[213]+=a[3]*b[158];
		c[214]+=a[3]*b[159];
		c[215]+=a[3]*b[160];
		c[216]+=a[3]*b[161];
		c[217]+=a[3]*b[162];
		c[218]+=a[3]*b[163];
		c[219]+=a[3]*b[164];

	if(order>9){

		c[165]+=a[0]*b[165];
		c[166]+=a[0]*b[166];
		c[167]+=a[0]*b[167];
		c[168]+=a[0]*b[168];
		c[169]+=a[0]*b[169];
		c[170]+=a[0]*b[170];
		c[171]+=a[0]*b[171];
		c[172]+=a[0]*b[172];
		c[173]+=a[0]*b[173];
		c[174]+=a[0]*b[174];
		c[175]+=a[0]*b[175];
		c[176]+=a[0]*b[176];
		c[177]+=a[0]*b[177];
		c[178]+=a[0]*b[178];
		c[179]+=a[0]*b[179];
		c[180]+=a[0]*b[180];
		c[181]+=a[0]*b[181];
		c[182]+=a[0]*b[182];
		c[183]+=a[0]*b[183];
		c[184]+=a[0]*b[184];
		c[185]+=a[0]*b[185];
		c[186]+=a[0]*b[186];
		c[187]+=a[0]*b[187];
		c[188]+=a[0]*b[188];
		c[189]+=a[0]*b[189];
		c[190]+=a[0]*b[190];
		c[191]+=a[0]*b[191];
		c[192]+=a[0]*b[192];
		c[193]+=a[0]*b[193];
		c[194]+=a[0]*b[194];
		c[195]+=a[0]*b[195];
		c[196]+=a[0]*b[196];
		c[197]+=a[0]*b[197];
		c[198]+=a[0]*b[198];
		c[199]+=a[0]*b[199];
		c[200]+=a[0]*b[200];
		c[201]+=a[0]*b[201];
		c[202]+=a[0]*b[202];
		c[203]+=a[0]*b[203];
		c[204]+=a[0]*b[204];
		c[205]+=a[0]*b[205];
		c[206]+=a[0]*b[206];
		c[207]+=a[0]*b[207];
		c[208]+=a[0]*b[208];
		c[209]+=a[0]*b[209];
		c[210]+=a[0]*b[210];
		c[211]+=a[0]*b[211];
		c[212]+=a[0]*b[212];
		c[213]+=a[0]*b[213];
		c[214]+=a[0]*b[214];
		c[215]+=a[0]*b[215];
		c[216]+=a[0]*b[216];
		c[217]+=a[0]*b[217];
		c[218]+=a[0]*b[218];
		c[219]+=a[0]*b[219];

		c[220]+=a[1]*b[165];
		c[221]+=a[1]*b[166];
		c[222]+=a[1]*b[167];
		c[223]+=a[1]*b[168];
		c[224]+=a[1]*b[169];
		c[225]+=a[1]*b[170];
		c[226]+=a[1]*b[171];
		c[227]+=a[1]*b[172];
		c[228]+=a[1]*b[173];
		c[229]+=a[1]*b[174];
		c[231]+=a[1]*b[175];
		c[232]+=a[1]*b[176];
		c[233]+=a[1]*b[177];
		c[234]+=a[1]*b[178];
		c[235]+=a[1]*b[179];
		c[236]+=a[1]*b[180];
		c[237]+=a[1]*b[181];
		c[238]+=a[1]*b[182];
		c[239]+=a[1]*b[183];
		c[241]+=a[1]*b[184];
		c[242]+=a[1]*b[185];
		c[243]+=a[1]*b[186];
		c[244]+=a[1]*b[187];
		c[245]+=a[1]*b[188];
		c[246]+=a[1]*b[189];
		c[247]+=a[1]*b[190];
		c[248]+=a[1]*b[191];
		c[250]+=a[1]*b[192];
		c[251]+=a[1]*b[193];
		c[252]+=a[1]*b[194];
		c[253]+=a[1]*b[195];
		c[254]+=a[1]*b[196];
		c[255]+=a[1]*b[197];
		c[256]+=a[1]*b[198];
		c[258]+=a[1]*b[199];
		c[259]+=a[1]*b[200];
		c[260]+=a[1]*b[201];
		c[261]+=a[1]*b[202];
		c[262]+=a[1]*b[203];
		c[263]+=a[1]*b[204];
		c[265]+=a[1]*b[205];
		c[266]+=a[1]*b[206];
		c[267]+=a[1]*b[207];
		c[268]+=a[1]*b[208];
		c[269]+=a[1]*b[209];
		c[271]+=a[1]*b[210];
		c[272]+=a[1]*b[211];
		c[273]+=a[1]*b[212];
		c[274]+=a[1]*b[213];
		c[276]+=a[1]*b[214];
		c[277]+=a[1]*b[215];
		c[278]+=a[1]*b[216];
		c[280]+=a[1]*b[217];
		c[281]+=a[1]*b[218];
		c[283]+=a[1]*b[219];

		c[221]+=a[2]*b[165];
		c[222]+=a[2]*b[166];
		c[223]+=a[2]*b[167];
		c[224]+=a[2]*b[168];
		c[225]+=a[2]*b[169];
		c[226]+=a[2]*b[170];
		c[227]+=a[2]*b[171];
		c[228]+=a[2]*b[172];
		c[229]+=a[2]*b[173];
		c[230]+=a[2]*b[174];
		c[232]+=a[2]*b[175];
		c[233]+=a[2]*b[176];
		c[234]+=a[2]*b[177];
		c[235]+=a[2]*b[178];
		c[236]+=a[2]*b[179];
		c[237]+=a[2]*b[180];
		c[238]+=a[2]*b[181];
		c[239]+=a[2]*b[182];
		c[240]+=a[2]*b[183];
		c[242]+=a[2]*b[184];
		c[243]+=a[2]*b[185];
		c[244]+=a[2]*b[186];
		c[245]+=a[2]*b[187];
		c[246]+=a[2]*b[188];
		c[247]+=a[2]*b[189];
		c[248]+=a[2]*b[190];
		c[249]+=a[2]*b[191];
		c[251]+=a[2]*b[192];
		c[252]+=a[2]*b[193];
		c[253]+=a[2]*b[194];
		c[254]+=a[2]*b[195];
		c[255]+=a[2]*b[196];
		c[256]+=a[2]*b[197];
		c[257]+=a[2]*b[198];
		c[259]+=a[2]*b[199];
		c[260]+=a[2]*b[200];
		c[261]+=a[2]*b[201];
		c[262]+=a[2]*b[202];
		c[263]+=a[2]*b[203];
		c[264]+=a[2]*b[204];
		c[266]+=a[2]*b[205];
		c[267]+=a[2]*b[206];
		c[268]+=a[2]*b[207];
		c[269]+=a[2]*b[208];
		c[270]+=a[2]*b[209];
		c[272]+=a[2]*b[210];
		c[273]+=a[2]*b[211];
		c[274]+=a[2]*b[212];
		c[275]+=a[2]*b[213];
		c[277]+=a[2]*b[214];
		c[278]+=a[2]*b[215];
		c[279]+=a[2]*b[216];
		c[281]+=a[2]*b[217];
		c[282]+=a[2]*b[218];
		c[284]+=a[2]*b[219];

		c[231]+=a[3]*b[165];
		c[232]+=a[3]*b[166];
		c[233]+=a[3]*b[167];
		c[234]+=a[3]*b[168];
		c[235]+=a[3]*b[169];
		c[236]+=a[3]*b[170];
		c[237]+=a[3]*b[171];
		c[238]+=a[3]*b[172];
		c[239]+=a[3]*b[173];
		c[240]+=a[3]*b[174];
		c[241]+=a[3]*b[175];
		c[242]+=a[3]*b[176];
		c[243]+=a[3]*b[177];
		c[244]+=a[3]*b[178];
		c[245]+=a[3]*b[179];
		c[246]+=a[3]*b[180];
		c[247]+=a[3]*b[181];
		c[248]+=a[3]*b[182];
		c[249]+=a[3]*b[183];
		c[250]+=a[3]*b[184];
		c[251]+=a[3]*b[185];
		c[252]+=a[3]*b[186];
		c[253]+=a[3]*b[187];
		c[254]+=a[3]*b[188];
		c[255]+=a[3]*b[189];
		c[256]+=a[3]*b[190];
		c[257]+=a[3]*b[191];
		c[258]+=a[3]*b[192];
		c[259]+=a[3]*b[193];
		c[260]+=a[3]*b[194];
		c[261]+=a[3]*b[195];
		c[262]+=a[3]*b[196];
		c[263]+=a[3]*b[197];
		c[264]+=a[3]*b[198];
		c[265]+=a[3]*b[199];
		c[266]+=a[3]*b[200];
		c[267]+=a[3]*b[201];
		c[268]+=a[3]*b[202];
		c[269]+=a[3]*b[203];
		c[270]+=a[3]*b[204];
		c[271]+=a[3]*b[205];
		c[272]+=a[3]*b[206];
		c[273]+=a[3]*b[207];
		c[274]+=a[3]*b[208];
		c[275]+=a[3]*b[209];
		c[276]+=a[3]*b[210];
		c[277]+=a[3]*b[211];
		c[278]+=a[3]*b[212];
		c[279]+=a[3]*b[213];
		c[280]+=a[3]*b[214];
		c[281]+=a[3]*b[215];
		c[282]+=a[3]*b[216];
		c[283]+=a[3]*b[217];
		c[284]+=a[3]*b[218];
		c[285]+=a[3]*b[219];

	if(order>10){

		c[220]+=a[0]*b[220];
		c[221]+=a[0]*b[221];
		c[222]+=a[0]*b[222];
		c[223]+=a[0]*b[223];
		c[224]+=a[0]*b[224];
		c[225]+=a[0]*b[225];
		c[226]+=a[0]*b[226];
		c[227]+=a[0]*b[227];
		c[228]+=a[0]*b[228];
		c[229]+=a[0]*b[229];
		c[230]+=a[0]*b[230];
		c[231]+=a[0]*b[231];
		c[232]+=a[0]*b[232];
		c[233]+=a[0]*b[233];
		c[234]+=a[0]*b[234];
		c[235]+=a[0]*b[235];
		c[236]+=a[0]*b[236];
		c[237]+=a[0]*b[237];
		c[238]+=a[0]*b[238];
		c[239]+=a[0]*b[239];
		c[240]+=a[0]*b[240];
		c[241]+=a[0]*b[241];
		c[242]+=a[0]*b[242];
		c[243]+=a[0]*b[243];
		c[244]+=a[0]*b[244];
		c[245]+=a[0]*b[245];
		c[246]+=a[0]*b[246];
		c[247]+=a[0]*b[247];
		c[248]+=a[0]*b[248];
		c[249]+=a[0]*b[249];
		c[250]+=a[0]*b[250];
		c[251]+=a[0]*b[251];
		c[252]+=a[0]*b[252];
		c[253]+=a[0]*b[253];
		c[254]+=a[0]*b[254];
		c[255]+=a[0]*b[255];
		c[256]+=a[0]*b[256];
		c[257]+=a[0]*b[257];
		c[258]+=a[0]*b[258];
		c[259]+=a[0]*b[259];
		c[260]+=a[0]*b[260];
		c[261]+=a[0]*b[261];
		c[262]+=a[0]*b[262];
		c[263]+=a[0]*b[263];
		c[264]+=a[0]*b[264];
		c[265]+=a[0]*b[265];
		c[266]+=a[0]*b[266];
		c[267]+=a[0]*b[267];
		c[268]+=a[0]*b[268];
		c[269]+=a[0]*b[269];
		c[270]+=a[0]*b[270];
		c[271]+=a[0]*b[271];
		c[272]+=a[0]*b[272];
		c[273]+=a[0]*b[273];
		c[274]+=a[0]*b[274];
		c[275]+=a[0]*b[275];
		c[276]+=a[0]*b[276];
		c[277]+=a[0]*b[277];
		c[278]+=a[0]*b[278];
		c[279]+=a[0]*b[279];
		c[280]+=a[0]*b[280];
		c[281]+=a[0]*b[281];
		c[282]+=a[0]*b[282];
		c[283]+=a[0]*b[283];
		c[284]+=a[0]*b[284];
		c[285]+=a[0]*b[285];

		c[286]+=a[1]*b[220];
		c[287]+=a[1]*b[221];
		c[288]+=a[1]*b[222];
		c[289]+=a[1]*b[223];
		c[290]+=a[1]*b[224];
		c[291]+=a[1]*b[225];
		c[292]+=a[1]*b[226];
		c[293]+=a[1]*b[227];
		c[294]+=a[1]*b[228];
		c[295]+=a[1]*b[229];
		c[296]+=a[1]*b[230];
		c[298]+=a[1]*b[231];
		c[299]+=a[1]*b[232];
		c[300]+=a[1]*b[233];
		c[301]+=a[1]*b[234];
		c[302]+=a[1]*b[235];
		c[303]+=a[1]*b[236];
		c[304]+=a[1]*b[237];
		c[305]+=a[1]*b[238];
		c[306]+=a[1]*b[239];
		c[307]+=a[1]*b[240];
		c[309]+=a[1]*b[241];
		c[310]+=a[1]*b[242];
		c[311]+=a[1]*b[243];
		c[312]+=a[1]*b[244];
		c[313]+=a[1]*b[245];
		c[314]+=a[1]*b[246];
		c[315]+=a[1]*b[247];
		c[316]+=a[1]*b[248];
		c[317]+=a[1]*b[249];
		c[319]+=a[1]*b[250];
		c[320]+=a[1]*b[251];
		c[321]+=a[1]*b[252];
		c[322]+=a[1]*b[253];
		c[323]+=a[1]*b[254];
		c[324]+=a[1]*b[255];
		c[325]+=a[1]*b[256];
		c[326]+=a[1]*b[257];
		c[328]+=a[1]*b[258];
		c[329]+=a[1]*b[259];
		c[330]+=a[1]*b[260];
		c[331]+=a[1]*b[261];
		c[332]+=a[1]*b[262];
		c[333]+=a[1]*b[263];
		c[334]+=a[1]*b[264];
		c[336]+=a[1]*b[265];
		c[337]+=a[1]*b[266];
		c[338]+=a[1]*b[267];
		c[339]+=a[1]*b[268];
		c[340]+=a[1]*b[269];
		c[341]+=a[1]*b[270];
		c[343]+=a[1]*b[271];
		c[344]+=a[1]*b[272];
		c[345]+=a[1]*b[273];
		c[346]+=a[1]*b[274];
		c[347]+=a[1]*b[275];
		c[349]+=a[1]*b[276];
		c[350]+=a[1]*b[277];
		c[351]+=a[1]*b[278];
		c[352]+=a[1]*b[279];
		c[354]+=a[1]*b[280];
		c[355]+=a[1]*b[281];
		c[356]+=a[1]*b[282];
		c[358]+=a[1]*b[283];
		c[359]+=a[1]*b[284];
		c[361]+=a[1]*b[285];

		c[287]+=a[2]*b[220];
		c[288]+=a[2]*b[221];
		c[289]+=a[2]*b[222];
		c[290]+=a[2]*b[223];
		c[291]+=a[2]*b[224];
		c[292]+=a[2]*b[225];
		c[293]+=a[2]*b[226];
		c[294]+=a[2]*b[227];
		c[295]+=a[2]*b[228];
		c[296]+=a[2]*b[229];
		c[297]+=a[2]*b[230];
		c[299]+=a[2]*b[231];
		c[300]+=a[2]*b[232];
		c[301]+=a[2]*b[233];
		c[302]+=a[2]*b[234];
		c[303]+=a[2]*b[235];
		c[304]+=a[2]*b[236];
		c[305]+=a[2]*b[237];
		c[306]+=a[2]*b[238];
		c[307]+=a[2]*b[239];
		c[308]+=a[2]*b[240];
		c[310]+=a[2]*b[241];
		c[311]+=a[2]*b[242];
		c[312]+=a[2]*b[243];
		c[313]+=a[2]*b[244];
		c[314]+=a[2]*b[245];
		c[315]+=a[2]*b[246];
		c[316]+=a[2]*b[247];
		c[317]+=a[2]*b[248];
		c[318]+=a[2]*b[249];
		c[320]+=a[2]*b[250];
		c[321]+=a[2]*b[251];
		c[322]+=a[2]*b[252];
		c[323]+=a[2]*b[253];
		c[324]+=a[2]*b[254];
		c[325]+=a[2]*b[255];
		c[326]+=a[2]*b[256];
		c[327]+=a[2]*b[257];
		c[329]+=a[2]*b[258];
		c[330]+=a[2]*b[259];
		c[331]+=a[2]*b[260];
		c[332]+=a[2]*b[261];
		c[333]+=a[2]*b[262];
		c[334]+=a[2]*b[263];
		c[335]+=a[2]*b[264];
		c[337]+=a[2]*b[265];
		c[338]+=a[2]*b[266];
		c[339]+=a[2]*b[267];
		c[340]+=a[2]*b[268];
		c[341]+=a[2]*b[269];
		c[342]+=a[2]*b[270];
		c[344]+=a[2]*b[271];
		c[345]+=a[2]*b[272];
		c[346]+=a[2]*b[273];
		c[347]+=a[2]*b[274];
		c[348]+=a[2]*b[275];
		c[350]+=a[2]*b[276];
		c[351]+=a[2]*b[277];
		c[352]+=a[2]*b[278];
		c[353]+=a[2]*b[279];
		c[355]+=a[2]*b[280];
		c[356]+=a[2]*b[281];
		c[357]+=a[2]*b[282];
		c[359]+=a[2]*b[283];
		c[360]+=a[2]*b[284];
		c[362]+=a[2]*b[285];

		c[298]+=a[3]*b[220];
		c[299]+=a[3]*b[221];
		c[300]+=a[3]*b[222];
		c[301]+=a[3]*b[223];
		c[302]+=a[3]*b[224];
		c[303]+=a[3]*b[225];
		c[304]+=a[3]*b[226];
		c[305]+=a[3]*b[227];
		c[306]+=a[3]*b[228];
		c[307]+=a[3]*b[229];
		c[308]+=a[3]*b[230];
		c[309]+=a[3]*b[231];
		c[310]+=a[3]*b[232];
		c[311]+=a[3]*b[233];
		c[312]+=a[3]*b[234];
		c[313]+=a[3]*b[235];
		c[314]+=a[3]*b[236];
		c[315]+=a[3]*b[237];
		c[316]+=a[3]*b[238];
		c[317]+=a[3]*b[239];
		c[318]+=a[3]*b[240];
		c[319]+=a[3]*b[241];
		c[320]+=a[3]*b[242];
		c[321]+=a[3]*b[243];
		c[322]+=a[3]*b[244];
		c[323]+=a[3]*b[245];
		c[324]+=a[3]*b[246];
		c[325]+=a[3]*b[247];
		c[326]+=a[3]*b[248];
		c[327]+=a[3]*b[249];
		c[328]+=a[3]*b[250];
		c[329]+=a[3]*b[251];
		c[330]+=a[3]*b[252];
		c[331]+=a[3]*b[253];
		c[332]+=a[3]*b[254];
		c[333]+=a[3]*b[255];
		c[334]+=a[3]*b[256];
		c[335]+=a[3]*b[257];
		c[336]+=a[3]*b[258];
		c[337]+=a[3]*b[259];
		c[338]+=a[3]*b[260];
		c[339]+=a[3]*b[261];
		c[340]+=a[3]*b[262];
		c[341]+=a[3]*b[263];
		c[342]+=a[3]*b[264];
		c[343]+=a[3]*b[265];
		c[344]+=a[3]*b[266];
		c[345]+=a[3]*b[267];
		c[346]+=a[3]*b[268];
		c[347]+=a[3]*b[269];
		c[348]+=a[3]*b[270];
		c[349]+=a[3]*b[271];
		c[350]+=a[3]*b[272];
		c[351]+=a[3]*b[273];
		c[352]+=a[3]*b[274];
		c[353]+=a[3]*b[275];
		c[354]+=a[3]*b[276];
		c[355]+=a[3]*b[277];
		c[356]+=a[3]*b[278];
		c[357]+=a[3]*b[279];
		c[358]+=a[3]*b[280];
		c[359]+=a[3]*b[281];
		c[360]+=a[3]*b[282];
		c[361]+=a[3]*b[283];
		c[362]+=a[3]*b[284];
		c[363]+=a[3]*b[285];

	if(order>11){

		c[286]+=a[0]*b[286];
		c[287]+=a[0]*b[287];
		c[288]+=a[0]*b[288];
		c[289]+=a[0]*b[289];
		c[290]+=a[0]*b[290];
		c[291]+=a[0]*b[291];
		c[292]+=a[0]*b[292];
		c[293]+=a[0]*b[293];
		c[294]+=a[0]*b[294];
		c[295]+=a[0]*b[295];
		c[296]+=a[0]*b[296];
		c[297]+=a[0]*b[297];
		c[298]+=a[0]*b[298];
		c[299]+=a[0]*b[299];
		c[300]+=a[0]*b[300];
		c[301]+=a[0]*b[301];
		c[302]+=a[0]*b[302];
		c[303]+=a[0]*b[303];
		c[304]+=a[0]*b[304];
		c[305]+=a[0]*b[305];
		c[306]+=a[0]*b[306];
		c[307]+=a[0]*b[307];
		c[308]+=a[0]*b[308];
		c[309]+=a[0]*b[309];
		c[310]+=a[0]*b[310];
		c[311]+=a[0]*b[311];
		c[312]+=a[0]*b[312];
		c[313]+=a[0]*b[313];
		c[314]+=a[0]*b[314];
		c[315]+=a[0]*b[315];
		c[316]+=a[0]*b[316];
		c[317]+=a[0]*b[317];
		c[318]+=a[0]*b[318];
		c[319]+=a[0]*b[319];
		c[320]+=a[0]*b[320];
		c[321]+=a[0]*b[321];
		c[322]+=a[0]*b[322];
		c[323]+=a[0]*b[323];
		c[324]+=a[0]*b[324];
		c[325]+=a[0]*b[325];
		c[326]+=a[0]*b[326];
		c[327]+=a[0]*b[327];
		c[328]+=a[0]*b[328];
		c[329]+=a[0]*b[329];
		c[330]+=a[0]*b[330];
		c[331]+=a[0]*b[331];
		c[332]+=a[0]*b[332];
		c[333]+=a[0]*b[333];
		c[334]+=a[0]*b[334];
		c[335]+=a[0]*b[335];
		c[336]+=a[0]*b[336];
		c[337]+=a[0]*b[337];
		c[338]+=a[0]*b[338];
		c[339]+=a[0]*b[339];
		c[340]+=a[0]*b[340];
		c[341]+=a[0]*b[341];
		c[342]+=a[0]*b[342];
		c[343]+=a[0]*b[343];
		c[344]+=a[0]*b[344];
		c[345]+=a[0]*b[345];
		c[346]+=a[0]*b[346];
		c[347]+=a[0]*b[347];
		c[348]+=a[0]*b[348];
		c[349]+=a[0]*b[349];
		c[350]+=a[0]*b[350];
		c[351]+=a[0]*b[351];
		c[352]+=a[0]*b[352];
		c[353]+=a[0]*b[353];
		c[354]+=a[0]*b[354];
		c[355]+=a[0]*b[355];
		c[356]+=a[0]*b[356];
		c[357]+=a[0]*b[357];
		c[358]+=a[0]*b[358];
		c[359]+=a[0]*b[359];
		c[360]+=a[0]*b[360];
		c[361]+=a[0]*b[361];
		c[362]+=a[0]*b[362];
		c[363]+=a[0]*b[363];

		c[364]+=a[1]*b[286];
		c[365]+=a[1]*b[287];
		c[366]+=a[1]*b[288];
		c[367]+=a[1]*b[289];
		c[368]+=a[1]*b[290];
		c[369]+=a[1]*b[291];
		c[370]+=a[1]*b[292];
		c[371]+=a[1]*b[293];
		c[372]+=a[1]*b[294];
		c[373]+=a[1]*b[295];
		c[374]+=a[1]*b[296];
		c[375]+=a[1]*b[297];
		c[377]+=a[1]*b[298];
		c[378]+=a[1]*b[299];
		c[379]+=a[1]*b[300];
		c[380]+=a[1]*b[301];
		c[381]+=a[1]*b[302];
		c[382]+=a[1]*b[303];
		c[383]+=a[1]*b[304];
		c[384]+=a[1]*b[305];
		c[385]+=a[1]*b[306];
		c[386]+=a[1]*b[307];
		c[387]+=a[1]*b[308];
		c[389]+=a[1]*b[309];
		c[390]+=a[1]*b[310];
		c[391]+=a[1]*b[311];
		c[392]+=a[1]*b[312];
		c[393]+=a[1]*b[313];
		c[394]+=a[1]*b[314];
		c[395]+=a[1]*b[315];
		c[396]+=a[1]*b[316];
		c[397]+=a[1]*b[317];
		c[398]+=a[1]*b[318];
		c[400]+=a[1]*b[319];
		c[401]+=a[1]*b[320];
		c[402]+=a[1]*b[321];
		c[403]+=a[1]*b[322];
		c[404]+=a[1]*b[323];
		c[405]+=a[1]*b[324];
		c[406]+=a[1]*b[325];
		c[407]+=a[1]*b[326];
		c[408]+=a[1]*b[327];
		c[410]+=a[1]*b[328];
		c[411]+=a[1]*b[329];
		c[412]+=a[1]*b[330];
		c[413]+=a[1]*b[331];
		c[414]+=a[1]*b[332];
		c[415]+=a[1]*b[333];
		c[416]+=a[1]*b[334];
		c[417]+=a[1]*b[335];
		c[419]+=a[1]*b[336];
		c[420]+=a[1]*b[337];
		c[421]+=a[1]*b[338];
		c[422]+=a[1]*b[339];
		c[423]+=a[1]*b[340];
		c[424]+=a[1]*b[341];
		c[425]+=a[1]*b[342];
		c[427]+=a[1]*b[343];
		c[428]+=a[1]*b[344];
		c[429]+=a[1]*b[345];
		c[430]+=a[1]*b[346];
		c[431]+=a[1]*b[347];
		c[432]+=a[1]*b[348];
		c[434]+=a[1]*b[349];
		c[435]+=a[1]*b[350];
		c[436]+=a[1]*b[351];
		c[437]+=a[1]*b[352];
		c[438]+=a[1]*b[353];
		c[440]+=a[1]*b[354];
		c[441]+=a[1]*b[355];
		c[442]+=a[1]*b[356];
		c[443]+=a[1]*b[357];
		c[445]+=a[1]*b[358];
		c[446]+=a[1]*b[359];
		c[447]+=a[1]*b[360];
		c[449]+=a[1]*b[361];
		c[450]+=a[1]*b[362];
		c[452]+=a[1]*b[363];

		c[365]+=a[2]*b[286];
		c[366]+=a[2]*b[287];
		c[367]+=a[2]*b[288];
		c[368]+=a[2]*b[289];
		c[369]+=a[2]*b[290];
		c[370]+=a[2]*b[291];
		c[371]+=a[2]*b[292];
		c[372]+=a[2]*b[293];
		c[373]+=a[2]*b[294];
		c[374]+=a[2]*b[295];
		c[375]+=a[2]*b[296];
		c[376]+=a[2]*b[297];
		c[378]+=a[2]*b[298];
		c[379]+=a[2]*b[299];
		c[380]+=a[2]*b[300];
		c[381]+=a[2]*b[301];
		c[382]+=a[2]*b[302];
		c[383]+=a[2]*b[303];
		c[384]+=a[2]*b[304];
		c[385]+=a[2]*b[305];
		c[386]+=a[2]*b[306];
		c[387]+=a[2]*b[307];
		c[388]+=a[2]*b[308];
		c[390]+=a[2]*b[309];
		c[391]+=a[2]*b[310];
		c[392]+=a[2]*b[311];
		c[393]+=a[2]*b[312];
		c[394]+=a[2]*b[313];
		c[395]+=a[2]*b[314];
		c[396]+=a[2]*b[315];
		c[397]+=a[2]*b[316];
		c[398]+=a[2]*b[317];
		c[399]+=a[2]*b[318];
		c[401]+=a[2]*b[319];
		c[402]+=a[2]*b[320];
		c[403]+=a[2]*b[321];
		c[404]+=a[2]*b[322];
		c[405]+=a[2]*b[323];
		c[406]+=a[2]*b[324];
		c[407]+=a[2]*b[325];
		c[408]+=a[2]*b[326];
		c[409]+=a[2]*b[327];
		c[411]+=a[2]*b[328];
		c[412]+=a[2]*b[329];
		c[413]+=a[2]*b[330];
		c[414]+=a[2]*b[331];
		c[415]+=a[2]*b[332];
		c[416]+=a[2]*b[333];
		c[417]+=a[2]*b[334];
		c[418]+=a[2]*b[335];
		c[420]+=a[2]*b[336];
		c[421]+=a[2]*b[337];
		c[422]+=a[2]*b[338];
		c[423]+=a[2]*b[339];
		c[424]+=a[2]*b[340];
		c[425]+=a[2]*b[341];
		c[426]+=a[2]*b[342];
		c[428]+=a[2]*b[343];
		c[429]+=a[2]*b[344];
		c[430]+=a[2]*b[345];
		c[431]+=a[2]*b[346];
		c[432]+=a[2]*b[347];
		c[433]+=a[2]*b[348];
		c[435]+=a[2]*b[349];
		c[436]+=a[2]*b[350];
		c[437]+=a[2]*b[351];
		c[438]+=a[2]*b[352];
		c[439]+=a[2]*b[353];
		c[441]+=a[2]*b[354];
		c[442]+=a[2]*b[355];
		c[443]+=a[2]*b[356];
		c[444]+=a[2]*b[357];
		c[446]+=a[2]*b[358];
		c[447]+=a[2]*b[359];
		c[448]+=a[2]*b[360];
		c[450]+=a[2]*b[361];
		c[451]+=a[2]*b[362];
		c[453]+=a[2]*b[363];

		c[377]+=a[3]*b[286];
		c[378]+=a[3]*b[287];
		c[379]+=a[3]*b[288];
		c[380]+=a[3]*b[289];
		c[381]+=a[3]*b[290];
		c[382]+=a[3]*b[291];
		c[383]+=a[3]*b[292];
		c[384]+=a[3]*b[293];
		c[385]+=a[3]*b[294];
		c[386]+=a[3]*b[295];
		c[387]+=a[3]*b[296];
		c[388]+=a[3]*b[297];
		c[389]+=a[3]*b[298];
		c[390]+=a[3]*b[299];
		c[391]+=a[3]*b[300];
		c[392]+=a[3]*b[301];
		c[393]+=a[3]*b[302];
		c[394]+=a[3]*b[303];
		c[395]+=a[3]*b[304];
		c[396]+=a[3]*b[305];
		c[397]+=a[3]*b[306];
		c[398]+=a[3]*b[307];
		c[399]+=a[3]*b[308];
		c[400]+=a[3]*b[309];
		c[401]+=a[3]*b[310];
		c[402]+=a[3]*b[311];
		c[403]+=a[3]*b[312];
		c[404]+=a[3]*b[313];
		c[405]+=a[3]*b[314];
		c[406]+=a[3]*b[315];
		c[407]+=a[3]*b[316];
		c[408]+=a[3]*b[317];
		c[409]+=a[3]*b[318];
		c[410]+=a[3]*b[319];
		c[411]+=a[3]*b[320];
		c[412]+=a[3]*b[321];
		c[413]+=a[3]*b[322];
		c[414]+=a[3]*b[323];
		c[415]+=a[3]*b[324];
		c[416]+=a[3]*b[325];
		c[417]+=a[3]*b[326];
		c[418]+=a[3]*b[327];
		c[419]+=a[3]*b[328];
		c[420]+=a[3]*b[329];
		c[421]+=a[3]*b[330];
		c[422]+=a[3]*b[331];
		c[423]+=a[3]*b[332];
		c[424]+=a[3]*b[333];
		c[425]+=a[3]*b[334];
		c[426]+=a[3]*b[335];
		c[427]+=a[3]*b[336];
		c[428]+=a[3]*b[337];
		c[429]+=a[3]*b[338];
		c[430]+=a[3]*b[339];
		c[431]+=a[3]*b[340];
		c[432]+=a[3]*b[341];
		c[433]+=a[3]*b[342];
		c[434]+=a[3]*b[343];
		c[435]+=a[3]*b[344];
		c[436]+=a[3]*b[345];
		c[437]+=a[3]*b[346];
		c[438]+=a[3]*b[347];
		c[439]+=a[3]*b[348];
		c[440]+=a[3]*b[349];
		c[441]+=a[3]*b[350];
		c[442]+=a[3]*b[351];
		c[443]+=a[3]*b[352];
		c[444]+=a[3]*b[353];
		c[445]+=a[3]*b[354];
		c[446]+=a[3]*b[355];
		c[447]+=a[3]*b[356];
		c[448]+=a[3]*b[357];
		c[449]+=a[3]*b[358];
		c[450]+=a[3]*b[359];
		c[451]+=a[3]*b[360];
		c[452]+=a[3]*b[361];
		c[453]+=a[3]*b[362];
		c[454]+=a[3]*b[363];
	} /* End if(order>11) */
	} /* End if(order>10) */
	} /* End if(order>9) */
	} /* End if(order>8) */
	} /* End if(order>7) */
	} /* End if(order>6) */
	} /* End if(order>5) */
	} /* End if(order>4) */
	} /* End if(order>3) */
	} /* End if(order>2) */
	} /* End if(order>1) */
	} /* End if(order>0) */
}

AIR_Error AIR_blat1000(double **nl, double **lin, const unsigned int order)

{
	if(order>AIR_CONFIG_MAXORDER) return AIR_POLYNOMIAL_ORDER_ERROR;
	{
		unsigned int coeffp=(order+1)*(order+2)*(order+3)/6;
		double **out=AIR_matrix2(coeffp,COORDS_INT);
		double *work1=AIR_matrix1(coeffp);
		double *work2=AIR_matrix1(coeffp);
	
		if(!out || !work1 || !work2){
			printf("%s: %d: ",__FILE__,__LINE__);
			printf("memory allocation failure\n");
			free_function(out,work1,work2);
			return AIR_MEMORY_ALLOCATION_ERROR;
		}
		{
			unsigned int m;
			
			for(m=0;m<COORDS_INT;m++){
				{
					unsigned int i;
					
					for(i=0;i<coeffp;i++){
						out[m][i]=0.0;
					}
				}
				out[m][0]+=nl[m][0];	/* Zeroth order */
			}
		}
		{
			unsigned int m;
			
			for(m=0;m<COORDS_INT;m++){
			
				unsigned int i=0;
				unsigned int currentorder=0;
	
				while(currentorder<order){
				
					currentorder++;
					coeffp=(currentorder+1)*(currentorder+2)*(currentorder+3)/6;
	
					{
						unsigned int j;
						
						for(j=0;j<coeffp;j++){
							work1[j]=0.0;
							work2[j]=0.0;
						}
					}
					{
						unsigned int xs=currentorder+1;
						unsigned int zs=0;
						
						while(zs<=currentorder){
						
							unsigned int ys=0;
							
							for(;xs--!=0;ys++){
							
								unsigned int k=1;
								signed int parity=1;
								
								i++;
								work1[0]=1.0;
								{
									unsigned int j;
									
									for(j=0;j<xs;j++){
										if(parity==1) by3(lin[0],work1,work2,k);
										else by3(lin[0],work2,work1,k);
										k++;
										parity*=-1;
									}
								}
								{
									unsigned int j;
									
									for(j=0;j<ys;j++){
										if(parity==1) by3(lin[1],work1,work2,k);
										else by3(lin[1],work2,work1,k);
										k++;
										parity*=-1;
									}
								}
								{
									unsigned int j;
									
									for(j=0;j<zs;j++){
										if(parity==1) by3(lin[2],work1,work2,k);
										else by3(lin[2],work2,work1,k);
										k++;
										parity*=-1;
									}
								}
								{
									unsigned int j;
									
									for(j=0;j<coeffp;j++){
										if(parity==-1){
											out[m][j]+=work2[j]*nl[m][i];
										}
										else{
											out[m][j]+=work1[j]*nl[m][i];
										}
									}
								}
							}
							zs++;
							xs=currentorder-zs+1;
						}
					}
				}
			}
		}
		{
			unsigned int m;
			
			for(m=0;m<COORDS_INT;m++){
	
				unsigned int j;
				
				for(j=0;j<coeffp;j++){
					nl[m][j]=out[m][j];
				}
			}
		}
		free_function(out,work1,work2);
		return 0;
	}
}
